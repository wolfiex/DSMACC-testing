 

Georgy “\+The Voronator” Voronoy

This is a fast, no-\/dependency library for computing the \href{https://en.wikipedia.org/wiki/Voronoi_diagram}{\tt Voronoi diagram} of a set of two-\/dimensional points. It is based on \href{https://github.com/mapbox/delaunator}{\tt Delaunator}, a fast library for computing the \href{https://en.wikipedia.org/wiki/Delaunay_triangulation}{\tt Delaunay triangulation} using \href{https://github.com/mapbox/delaunator/blob/master/README.md#papers}{\tt sweep algorithms}. The Voronoi diagram is constructed by connecting the circumcenters of adjacent triangles in the Delaunay triangulation.

For an interactive explanation of how this library works, see \href{https://observablehq.com/@mbostock/the-delaunays-dual}{\tt The Delaunay’s Dual}.

\subsection*{Installing}

To install, {\ttfamily npm install d3-\/delaunay} or {\ttfamily yarn add d3-\/delaunay}. You can also download the \href{https://github.com/d3/d3-delaunay/releases/latest}{\tt latest release} or load directly from \href{https://unpkg.com/d3-delaunay/}{\tt unpkg}. A\+MD, Common\+JS and E\+S6+ environments are supported. In vanilla, a {\ttfamily d3} global is exported.


\begin{DoxyCode}
import \{Delaunay\} from "d3-delaunay";

const points = [[0, 0], [0, 1], [1, 0], [1, 1]];
const delaunay = Delaunay.from(points);
const voronoi = delaunay.voronoi([0, 0, 960, 500]);
\end{DoxyCode}


\subsection*{A\+PI Reference}

\subsubsection*{Delaunay}

\href{#new_Delaunay}{\tt \#} new {\bfseries Delaunay}({\itshape points}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns the Delaunay triangulation for the given flat array \mbox{[}{\itshape x0}, {\itshape y0}, {\itshape x1}, {\itshape y1}, …\mbox{]} of {\itshape points}.


\begin{DoxyCode}
const delaunay = new Delaunay(Float64Array.of(0, 0, 0, 1, 1, 0, 1, 1));
\end{DoxyCode}


\href{#delaunay_from}{\tt \#} Delaunay.{\bfseries from}({\itshape points}\mbox{[}, {\itshape fx}\mbox{[}, {\itshape fy}\mbox{[}, {\itshape that}\mbox{]}\mbox{]}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns the Delaunay triangulation for the given array or iterable of {\itshape points}. If {\itshape fx} and {\itshape fy} are not specified, then {\itshape points} is assumed to be an array of two-\/element arrays of numbers\+: \mbox{[}\mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}, \mbox{[}{\itshape x1}, {\itshape y1}\mbox{]}, …\mbox{]}. Otherwise, {\itshape fx} and {\itshape fy} are functions that are invoked for each element in the {\itshape points} array in order, and must return the respective {\itshape x}-\/ and {\itshape y}-\/coordinate for each point. If {\itshape that} is specified, the functions {\itshape fx} and {\itshape fy} are invoked with {\itshape that} as {\itshape this}. (See \href{https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/from}{\tt Array.\+from} for reference.)


\begin{DoxyCode}
const delaunay = Delaunay.from([[0, 0], [0, 1], [1, 0], [1, 1]]);
\end{DoxyCode}


\href{#delaunay_points}{\tt \#} {\itshape delaunay}.{\bfseries points}

The coordinates of the points as an array \mbox{[}{\itshape x0}, {\itshape y0}, {\itshape x1}, {\itshape y1}, …\mbox{]}. Typically, this is a Float64\+Array, however you can use any array-\/like type in the \href{#new_Delaunay}{\tt constructor}.

\href{#delaunay_halfedges}{\tt \#} {\itshape delaunay}.{\bfseries halfedges}

The halfedge indexes as an Int32\+Array \mbox{[}{\itshape j0}, {\itshape j1}, …\mbox{]}. For each index 0 ≤ {\itshape i} $<$ {\itshape halfedges}.length, there is a halfedge from triangle vertex {\itshape j} = {\itshape halfedges}\mbox{[}{\itshape i}\mbox{]} to triangle vertex {\itshape i}. Equivalently, this means that triangle ⌊$\ast$i$\ast$ / 3⌋ is adjacent to triangle ⌊$\ast$j$\ast$ / 3⌋. If {\itshape j} is negative, then triangle ⌊$\ast$i$\ast$ / 3⌋ is an exterior triangle on the \href{#delaunay_hull}{\tt convex hull}. For example, to render the internal edges of the Delaunay triangulation\+:


\begin{DoxyCode}
const \{points, halfedges, triangles\} = delaunay;
for (let i = 0, n = halfedges.length; i < n; ++i) \{
  const j = halfedges[i];
  if (j < i) continue;
  const ti = triangles[i];
  const tj = triangles[j];
  context.moveTo(points[ti * 2], points[ti * 2 + 1]);
  context.lineTo(points[tj * 2], points[tj * 2 + 1]);
\}
\end{DoxyCode}


See also \href{#delaunay_render}{\tt {\itshape delaunay}.render}.

\href{#delaunay_hull}{\tt \#} {\itshape delaunay}.{\bfseries hull}

An Int32\+Array of point indexes that form the convex hull in counterclockwise order. If the points are collinear, returns them ordered.

See also \href{#delaunay_renderHull}{\tt {\itshape delaunay}.render\+Hull}.

\href{#delaunay_triangles}{\tt \#} {\itshape delaunay}.{\bfseries triangles}

The triangle vertex indexes as an Uint32\+Array \mbox{[}{\itshape i0}, {\itshape j0}, {\itshape k0}, {\itshape i1}, {\itshape j1}, {\itshape k1}, …\mbox{]}. Each contiguous triplet of indexes {\itshape i}, {\itshape j}, {\itshape k} forms a counterclockwise triangle. The coordinates of the triangle’s points can be found by going through \href{#delaunay_points}{\tt {\itshape delaunay}.points}. For example, to render triangle {\itshape i}\+:


\begin{DoxyCode}
const \{points, triangles\} = delaunay;
const t0 = triangles[i * 3 + 0];
const t1 = triangles[i * 3 + 1];
const t2 = triangles[i * 3 + 2];
context.moveTo(points[t0 * 2], points[t0 * 2 + 1]);
context.lineTo(points[t1 * 2], points[t1 * 2 + 1]);
context.lineTo(points[t2 * 2], points[t2 * 2 + 1]);
context.closePath();
\end{DoxyCode}


See also \href{#delaunay_renderTriangle}{\tt {\itshape delaunay}.render\+Triangle}.

\href{#delaunay_inedges}{\tt \#} {\itshape delaunay}.{\bfseries inedges}

The incoming halfedge indexes as a Int32\+Array \mbox{[}{\itshape e0}, {\itshape e1}, {\itshape e2}, …\mbox{]}. For each point {\itshape i}, {\itshape inedges}\mbox{[}{\itshape i}\mbox{]} is the halfedge index {\itshape e} of an incoming halfedge. For coincident points, the halfedge index is -\/1; for points on the convex hull, the incoming halfedge is on the convex hull; for other points, the choice of incoming halfedge is arbitrary. The {\itshape inedges} table can be used to traverse the Delaunay triangulation; see also \href{#delaunay_neighbors}{\tt {\itshape delaunay}.neighbors}.

\href{#delaunay_find}{\tt \#} {\itshape delaunay}.{\bfseries find}({\itshape x}, {\itshape y}\mbox{[}, {\itshape i}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns the index of the input point that is closest to the specified point ⟨$\ast$x$\ast$, {\itshape y$\ast$⟩. The search is started at the specified point $\ast$i}. If {\itshape i} is not specified, it defaults to zero.

\href{#delaunay_neighbors}{\tt \#} {\itshape delaunay}.{\bfseries neighbors}({\itshape i}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns an iterable over the indexes of the neighboring points to the specified point {\itshape i}. The iterable is empty if {\itshape i} is a coincident point.

\href{#delaunay_render}{\tt \#} {\itshape delaunay}.{\bfseries render}(\mbox{[}{\itshape context}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}



Renders the edges of the Delaunay triangulation to the specified {\itshape context}. The specified {\itshape context} must implement the {\itshape context}.move\+To and {\itshape context}.line\+To methods from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#delaunay_renderHull}{\tt \#} {\itshape delaunay}.{\bfseries render\+Hull}(\mbox{[}{\itshape context}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}



Renders the convex hull of the Delaunay triangulation to the specified {\itshape context}. The specified {\itshape context} must implement the {\itshape context}.move\+To and {\itshape context}.line\+To methods from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#delaunay_renderTriangle}{\tt \#} {\itshape delaunay}.{\bfseries render\+Triangle}({\itshape i}\mbox{[}, {\itshape context}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}



Renders triangle {\itshape i} of the Delaunay triangulation to the specified {\itshape context}. The specified {\itshape context} must implement the {\itshape context}.move\+To, {\itshape context}.line\+To and {\itshape context}.close\+Path methods from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#delaunay_renderPoints}{\tt \#} {\itshape delaunay}.{\bfseries render\+Points}(\mbox{[}{\itshape context}\mbox{]}\mbox{[}, {\itshape radius}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Renders the input points of the Delaunay triangulation to the specified {\itshape context} as circles with the specified {\itshape radius}. If {\itshape radius} is not specified, it defaults to 2. The specified {\itshape context} must implement the {\itshape context}.move\+To and {\itshape context}.arc methods from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#delaunay_hullPolygon}{\tt \#} {\itshape delaunay}.{\bfseries hull\+Polygon()} \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns the closed polygon \mbox{[}\mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}, \mbox{[}{\itshape x1}, {\itshape y1}\mbox{]}, …, \mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}\mbox{]} representing the convex hull.

\href{#delaunay_trianglePolygons}{\tt \#} {\itshape delaunay}.{\bfseries triangle\+Polygons()} \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns an iterable over the \href{#delaunay_trianglePolygon}{\tt polygons for each triangle}, in order.

\href{#delaunay_trianglePolygon}{\tt \#} {\itshape delaunay}.{\bfseries triangle\+Polygon({\itshape i})} \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns the closed polygon \mbox{[}\mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}, \mbox{[}{\itshape x1}, {\itshape y1}\mbox{]}, \mbox{[}{\itshape x2}, {\itshape y2}\mbox{]}, \mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}\mbox{]} representing the triangle {\itshape i}.

\href{#delaunay_update}{\tt \#} {\itshape delaunay}.{\bfseries update}() \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Updates the triangulation after the points have been modified in-\/place.

\href{#delaunay_voronoi}{\tt \#} {\itshape delaunay}.{\bfseries voronoi}(\mbox{[}{\itshape bounds}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/delaunay.js}{\tt $<$$>$}

Returns the \href{#voronoi}{\tt Voronoi diagram} for the associated \href{#delaunay_points}{\tt points}. When rendering, the diagram will be clipped to the specified {\itshape bounds} = \mbox{[}{\itshape xmin}, {\itshape ymin}, {\itshape xmax}, {\itshape ymax}\mbox{]}. If {\itshape bounds} is not specified, it defaults to \mbox{[}0, 0, 960, 500\mbox{]}. See \href{https://observablehq.com/@mbostock/to-infinity-and-back-again}{\tt To Infinity and Back Again} for an interactive explanation of Voronoi cell clipping.

The Voronoi diagram is returned even in degenerate cases where no triangulation exists — namely 0, 1 or 2 points, and collinear points.

\subsubsection*{Voronoi}

\href{#voronoi_delaunay}{\tt \#} {\itshape voronoi}.{\bfseries delaunay}

The Voronoi diagram’s associated \href{#delaunay}{\tt Delaunay triangulation}.

\href{#voronoi_circumcenters}{\tt \#} {\itshape voronoi}.{\bfseries circumcenters}

The \href{http://mathworld.wolfram.com/Circumcenter.html}{\tt circumcenters} of the Delaunay triangles as a Float64\+Array \mbox{[}{\itshape cx0}, {\itshape cy0}, {\itshape cx1}, {\itshape cy1}, …\mbox{]}. Each contiguous pair of coordinates {\itshape cx}, {\itshape cy} is the circumcenter for the corresponding triangle. These circumcenters form the coordinates of the Voronoi cell polygons.

\href{#voronoi_vectors}{\tt \#} {\itshape voronoi}.{\bfseries vectors}

An Uint64\+Array \mbox{[}{\itshape vx0}, {\itshape vy0}, {\itshape wx0}, {\itshape wy0}, …\mbox{]} where each non-\/zero quadruple describes an open (infinite) cell on the outer hull, giving the directions of two open half-\/lines.

\href{#voronoi_xmin}{\tt \#} {\itshape voronoi}.{\bfseries xmin}~\newline
 \href{#voronoi_ymin}{\tt \#} {\itshape voronoi}.{\bfseries ymin}~\newline
 \href{#voronoi_xmax}{\tt \#} {\itshape voronoi}.{\bfseries xmax}~\newline
 \href{#voronoi_ymax}{\tt \#} {\itshape voronoi}.{\bfseries ymax}~\newline


The bounds of the viewport \mbox{[}{\itshape xmin}, {\itshape ymin}, {\itshape xmax}, {\itshape ymax}\mbox{]} for rendering the Voronoi diagram. These values only affect the rendering methods (\href{#voronoi_render}{\tt {\itshape voronoi}.render}, \href{#voronoi_renderBounds}{\tt {\itshape voronoi}.render\+Bounds}, \href{#cell_render}{\tt {\itshape cell}.render}).

\href{#voronoi_contains}{\tt \#} {\itshape voronoi}.{\bfseries contains}({\itshape i}, {\itshape x}, {\itshape y}) \href{https://github.com/d3/d3-delaunay/blob/master/src/cell.js}{\tt $<$$>$}

Returns true if the cell with the specified index {\itshape i} contains the specified point ⟨$\ast$x$\ast$, $\ast$y$\ast$⟩. (This method is not affected by the associated Voronoi diagram’s viewport \href{#voronoi_xmin}{\tt bounds}.)

\href{#voronoi_render}{\tt \#} {\itshape voronoi}.{\bfseries render}(\mbox{[}{\itshape context}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/voronoi.js}{\tt $<$$>$}



Renders the mesh of Voronoi cells to the specified {\itshape context}. The specified {\itshape context} must implement the {\itshape context}.move\+To and {\itshape context}.line\+To methods from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#voronoi_renderBounds}{\tt \#} {\itshape voronoi}.{\bfseries render\+Bounds}(\mbox{[}{\itshape context}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/voronoi.js}{\tt $<$$>$}



Renders the viewport extent to the specified {\itshape context}. The specified {\itshape context} must implement the {\itshape context}.rect method from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. Equivalent to {\itshape context}.rect({\itshape voronoi}.xmin, {\itshape voronoi}.ymin, {\itshape voronoi}.xmax -\/ {\itshape voronoi}.xmin, {\itshape voronoi}.ymax -\/ {\itshape voronoi}.ymin). If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#voronoi_renderCell}{\tt \#} {\itshape voronoi}.{\bfseries render\+Cell}({\itshape i}\mbox{[}, {\itshape context}\mbox{]}) \href{https://github.com/d3/d3-delaunay/blob/master/src/voronoi.js}{\tt $<$$>$}



Renders the cell with the specified index {\itshape i} to the specified {\itshape context}. The specified {\itshape context} must implement the {\itshape context}.move\+To , {\itshape context}.line\+To and {\itshape context}.close\+Path methods from the \href{https://www.w3.org/TR/2dcontext/#canvaspathmethods}{\tt Canvas\+Path\+Methods A\+PI}. If a {\itshape context} is not specified, an S\+VG path string is returned instead.

\href{#voronoi_cellPolygons}{\tt \#} {\itshape voronoi}.{\bfseries cell\+Polygons}() \href{https://github.com/d3/d3-delaunay/blob/master/src/voronoi.js}{\tt $<$$>$}

Returns an iterable over the \href{#voronoi_cellPolygon}{\tt polygons for each cell}, in order.

\href{#voronoi_cellPolygon}{\tt \#} {\itshape voronoi}.{\bfseries cell\+Polygon}({\itshape i}) \href{https://github.com/d3/d3-delaunay/blob/master/src/voronoi.js}{\tt $<$$>$}

Returns the convex, closed polygon \mbox{[}\mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}, \mbox{[}{\itshape x1}, {\itshape y1}\mbox{]}, …, \mbox{[}{\itshape x0}, {\itshape y0}\mbox{]}\mbox{]} representing the cell for the specified point {\itshape i}.

\href{#voronoi_update}{\tt \#} {\itshape voronoi}.{\bfseries update}() \href{https://github.com/d3/d3-delaunay/blob/master/src/voronoi.js}{\tt $<$$>$}

Updates the Voronoi diagram and underlying triangulation after the points have been modified in-\/place — useful for Lloyd’s relaxation. 