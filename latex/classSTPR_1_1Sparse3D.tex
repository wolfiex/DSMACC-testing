\hypertarget{classSTPR_1_1Sparse3D}{}\section{S\+T\+P\+R.\+Sparse3D Class Reference}
\label{classSTPR_1_1Sparse3D}\index{S\+T\+P\+R.\+Sparse3D@{S\+T\+P\+R.\+Sparse3D}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a5cd2f5219647a546d499b15070a8baea}\label{classSTPR_1_1Sparse3D_a5cd2f5219647a546d499b15070a8baea}} 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self, adjacency\+\_\+matrix=None, names=None, onnone=0)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_aff961f2a4ff5f45ad491dddfde3c023b}\label{classSTPR_1_1Sparse3D_aff961f2a4ff5f45ad491dddfde3c023b}} 
def {\bfseries add} (self, source, target, values)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_afeb84c06d9579421012decb5c25a5db8}\label{classSTPR_1_1Sparse3D_afeb84c06d9579421012decb5c25a5db8}} 
def {\bfseries read} (self, source, target)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a9513e88514c6d7ae4f66089646edf67d}\label{classSTPR_1_1Sparse3D_a9513e88514c6d7ae4f66089646edf67d}} 
def {\bfseries reverse} (self)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a0666a9cd963240af5ed633e506a0cf5e}\label{classSTPR_1_1Sparse3D_a0666a9cd963240af5ed633e506a0cf5e}} 
def {\bfseries get\+\_\+rowkeys} (self, fn=\textquotesingle{}csc\+\_\+keys\textquotesingle{})
\item 
def \mbox{\hyperlink{classSTPR_1_1Sparse3D_a8d672996a1916e3d660778962c20bfcf}{get\+\_\+colkeys}} (self, fn=\textquotesingle{}csc\+\_\+keys\textquotesingle{})
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a311c2374450de54545d534eee53e5f9a}\label{classSTPR_1_1Sparse3D_a311c2374450de54545d534eee53e5f9a}} 
def {\bfseries log10normalise} (self, minlink=0.\+001, zeronans=False)
\item 
def \mbox{\hyperlink{classSTPR_1_1Sparse3D_a1254a87d6986bbfb8e86270bde3856b6}{to\+\_\+numpy\+\_\+matrix}} (self, elementnumber=0, parray=None)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a6c0c03e9c6035490d02ee346e3244a97}\label{classSTPR_1_1Sparse3D_a6c0c03e9c6035490d02ee346e3244a97}} 
def {\bfseries csc\+\_\+keys} (self)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_aee461121029774a17fe6eea8d4dcce2b}\label{classSTPR_1_1Sparse3D_aee461121029774a17fe6eea8d4dcce2b}} 
def {\bfseries csr\+\_\+keys} (self)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a6525586a402855d4b5cd4ad959eee8f5}\label{classSTPR_1_1Sparse3D_a6525586a402855d4b5cd4ad959eee8f5}} 
def {\bfseries keys} (self)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a6aef3cae71b24581e1d517192a50740d}\label{classSTPR_1_1Sparse3D_a6aef3cae71b24581e1d517192a50740d}} 
def {\bfseries init\+\_\+pr} (self)
\item 
def \mbox{\hyperlink{classSTPR_1_1Sparse3D_add417073a46122cadb2c720840deec12}{googley}} (self, timestep=0, alpha=0.\+85, parray=None, personalization=None, nodelist=None, dangling=None)
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_aa784d6697a021aa40afc4115b430740c}\label{classSTPR_1_1Sparse3D_aa784d6697a021aa40afc4115b430740c}} 
def {\bfseries pr} (self, timestep=0, alpha=0.\+85, parray=None, personalization=None)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_aa0d4db1227bc48980a6347c6dbcd7db0}\label{classSTPR_1_1Sparse3D_aa0d4db1227bc48980a6347c6dbcd7db0}} 
{\bfseries onnone}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a21f2680bd7dc93ded2d7236a9f442edc}\label{classSTPR_1_1Sparse3D_a21f2680bd7dc93ded2d7236a9f442edc}} 
{\bfseries data}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_af63baac06c0f65d7e90c1ff08f2589c3}\label{classSTPR_1_1Sparse3D_af63baac06c0f65d7e90c1ff08f2589c3}} 
{\bfseries rowkeys}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_af441c649424bce52b649b2c3c3de5c9c}\label{classSTPR_1_1Sparse3D_af441c649424bce52b649b2c3c3de5c9c}} 
{\bfseries colkeys}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a0546515d650529c52de56abcf2dd4e39}\label{classSTPR_1_1Sparse3D_a0546515d650529c52de56abcf2dd4e39}} 
{\bfseries number\+\_\+timesteps}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_ac6f9ddcdf3fa051c64feb14ec111b16e}\label{classSTPR_1_1Sparse3D_ac6f9ddcdf3fa051c64feb14ec111b16e}} 
{\bfseries rsum}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a4905544c130463ee391a22c9c1e69d6e}\label{classSTPR_1_1Sparse3D_a4905544c130463ee391a22c9c1e69d6e}} 
dictionary {\bfseries data} = \{\}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a350a4fbe483261f8245dc588fb542b0e}\label{classSTPR_1_1Sparse3D_a350a4fbe483261f8245dc588fb542b0e}} 
{\bfseries names} = None
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a58a0ecc49680c6d7c2b8f8fae034fb9c}\label{classSTPR_1_1Sparse3D_a58a0ecc49680c6d7c2b8f8fae034fb9c}} 
list {\bfseries log10log} = \mbox{[}False,False\mbox{]}
\item 
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_aaaca2c2b88e34b2259c38feccaf23f8e}\label{classSTPR_1_1Sparse3D_aaaca2c2b88e34b2259c38feccaf23f8e}} 
int {\bfseries reversed} = 0
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}A 3 Dimentional sparse matrix represenatation.

Autoinput:
    adjacency - n x n matrix of value items (items can be anything)
    names - list of names (e.g. G.nodes())

onnone:
    value or object to return when a non-existant link is summoned.
\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a8d672996a1916e3d660778962c20bfcf}\label{classSTPR_1_1Sparse3D_a8d672996a1916e3d660778962c20bfcf}} 
\index{S\+T\+P\+R\+::\+Sparse3D@{S\+T\+P\+R\+::\+Sparse3D}!get\+\_\+colkeys@{get\+\_\+colkeys}}
\index{get\+\_\+colkeys@{get\+\_\+colkeys}!S\+T\+P\+R\+::\+Sparse3D@{S\+T\+P\+R\+::\+Sparse3D}}
\subsubsection{\texorpdfstring{get\+\_\+colkeys()}{get\_colkeys()}}
{\footnotesize\ttfamily def S\+T\+P\+R.\+Sparse3\+D.\+get\+\_\+colkeys (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{fn = {\ttfamily \textquotesingle{}csc\+\_\+keys\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}goes into keys
fn [keys, csc_keys, csc_keys]
\end{DoxyVerb}
 
\begin{DoxyCode}
59       \textcolor{keyword}{def }get\_colkeys (self, fn = 'csc\_keys'):
60           \textcolor{stringliteral}{'''}
61 \textcolor{stringliteral}{          goes into keys}
62 \textcolor{stringliteral}{          fn [keys, csc\_keys, csc\_keys]}
63 \textcolor{stringliteral}{          '''}
64           fn = getattr(self,fn)
65           self.colkeys = [filter(\textcolor{keyword}{lambda} x: x[1] \textcolor{keywordflow}{is} i, fn()) \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(self.names))]
66       
67       
\end{DoxyCode}
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_add417073a46122cadb2c720840deec12}\label{classSTPR_1_1Sparse3D_add417073a46122cadb2c720840deec12}} 
\index{S\+T\+P\+R\+::\+Sparse3D@{S\+T\+P\+R\+::\+Sparse3D}!googley@{googley}}
\index{googley@{googley}!S\+T\+P\+R\+::\+Sparse3D@{S\+T\+P\+R\+::\+Sparse3D}}
\subsubsection{\texorpdfstring{googley()}{googley()}}
{\footnotesize\ttfamily def S\+T\+P\+R.\+Sparse3\+D.\+googley (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{timestep = {\ttfamily 0},  }\item[{}]{alpha = {\ttfamily 0.85},  }\item[{}]{parray = {\ttfamily None},  }\item[{}]{personalization = {\ttfamily None},  }\item[{}]{nodelist = {\ttfamily None},  }\item[{}]{dangling = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a google_matrix for our data. See networkx documentation for more information. 
  Inputs: 
    alpha - damping factor (float)
    timestep - [weight array index or 'teleport' or a random selection] (number|str)
    parray - probability array for time selection if using 'teleport' (list)
    personalisation - optional node weightings corresponding to importance (dict)\end{DoxyVerb}
 
\begin{DoxyCode}
148       \textcolor{keyword}{def }googley (self, timestep = 0 , alpha = 0.85, parray = None , personalization = None, 
      nodelist=None, dangling=None):
149             \textcolor{stringliteral}{''' }
150 \textcolor{stringliteral}{            Create a google\_matrix for our data. See networkx documentation for more information. }
151 \textcolor{stringliteral}{              Inputs: }
152 \textcolor{stringliteral}{                alpha - damping factor (float)}
153 \textcolor{stringliteral}{                timestep - [weight array index or 'teleport' or a random selection] (number|str)}
154 \textcolor{stringliteral}{                parray - probability array for time selection if using 'teleport' (list)}
155 \textcolor{stringliteral}{                personalisation - optional node weightings corresponding to importance (dict)}
156 \textcolor{stringliteral}{                '''}
157             \textcolor{keywordflow}{try}: self.number\_timesteps
158             \textcolor{keywordflow}{except}: self.number\_timesteps = len(self.data.values()[0])
159                
160             n = len(self.names)
161             \textcolor{keywordflow}{if} personalization \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:  p = np.repeat(1.0 / float(n), n)
162             
163             \textcolor{keywordflow}{else}:
164                   p = np.array([personalization.get(n, 0) \textcolor{keywordflow}{for} n \textcolor{keywordflow}{in} self.names], dtype=float)
165                   p /= p.sum()
166             
167             M = self.to\_numpy\_matrix(elementnumber=timestep,parray=parray)[0]
168             \textcolor{comment}{# Assign dangling\_weights to any dangling nodes (nodes with no out links)}
169             \textcolor{comment}{# Dangling nodes}
170             \textcolor{keywordflow}{if} dangling \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
171                 dangling\_weights = p
172             \textcolor{keywordflow}{else}:
173                 \textcolor{comment}{# Convert the dangling dictionary into an array in nodelist order}
174                 dangling\_weights = np.array([dangling.get(n, 0) \textcolor{keywordflow}{for} n \textcolor{keywordflow}{in} nodelist],
175                                             dtype=float)
176                 dangling\_weights /= dangling\_weights.sum()
177             dangling\_nodes = np.where(M.sum(axis=1) == 0)[0]
178 
179             \textcolor{comment}{# Assign dangling\_weights to any dangling nodes (nodes with no out links)}
180             \textcolor{keywordflow}{for} node \textcolor{keywordflow}{in} dangling\_nodes:
181                 M[node] = dangling\_weights
182                 
183             \textcolor{keywordflow}{return} M*alpha + (1 - alpha) * p
184 
\end{DoxyCode}
\mbox{\Hypertarget{classSTPR_1_1Sparse3D_a1254a87d6986bbfb8e86270bde3856b6}\label{classSTPR_1_1Sparse3D_a1254a87d6986bbfb8e86270bde3856b6}} 
\index{S\+T\+P\+R\+::\+Sparse3D@{S\+T\+P\+R\+::\+Sparse3D}!to\+\_\+numpy\+\_\+matrix@{to\+\_\+numpy\+\_\+matrix}}
\index{to\+\_\+numpy\+\_\+matrix@{to\+\_\+numpy\+\_\+matrix}!S\+T\+P\+R\+::\+Sparse3D@{S\+T\+P\+R\+::\+Sparse3D}}
\subsubsection{\texorpdfstring{to\+\_\+numpy\+\_\+matrix()}{to\_numpy\_matrix()}}
{\footnotesize\ttfamily def S\+T\+P\+R.\+Sparse3\+D.\+to\+\_\+numpy\+\_\+matrix (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{elementnumber = {\ttfamily 0},  }\item[{}]{parray = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Function to return an adjacency matrix for a certain timestep 
Inputs:
    elementnumber [numerical index or 'teleport']
    parray - if teleporting we can specify a probability array for picking each timestep (more important times)
    
Returns: 
   list (matrix, node names, elementnumber)
\end{DoxyVerb}
 
\begin{DoxyCode}
93       \textcolor{keyword}{def }to\_numpy\_matrix(self,elementnumber=0, parray = None): 
94           \textcolor{stringliteral}{''' }
95 \textcolor{stringliteral}{          Function to return an adjacency matrix for a certain timestep }
96 \textcolor{stringliteral}{          Inputs:}
97 \textcolor{stringliteral}{              elementnumber [numerical index or 'teleport']}
98 \textcolor{stringliteral}{              parray - if teleporting we can specify a probability array for picking each timestep (more
       important times)}
99 \textcolor{stringliteral}{              }
100 \textcolor{stringliteral}{          Returns: }
101 \textcolor{stringliteral}{             list (matrix, node names, elementnumber)}
102 \textcolor{stringliteral}{          '''}
103           n = len(self.names)
104           rt = np.zeros((n,n))
105           
106           \textcolor{keywordflow}{if} elementnumber == \textcolor{stringliteral}{'teleport'}:
107                 \textcolor{keywordflow}{try}: self.number\_timesteps
108                 \textcolor{keywordflow}{except}: self.number\_timesteps = len(self.data.values()[0])
109                 tsrange = range(self.number\_timesteps)
110                         
111           \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.data:
112               \textcolor{keywordflow}{if} elementnumber == \textcolor{stringliteral}{'teleport'}:
113                   \textcolor{comment}{#select a new teleportation link at random. }
114                   elementnumber = np.random.choice(tsrange, replace=\textcolor{keyword}{False}, p=parray)
115               rt[i[0],i[1]] = self.data[i][elementnumber]
116               
117           \textcolor{keywordflow}{return} (rt,self.names,elementnumber)
118             
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
Other/\+Iterative\+Temporal\+Page\+Rank/\+S\+T\+P\+R/\+\_\+\+\_\+init\+\_\+\+\_\+.\+py\end{DoxyCompactItemize}
