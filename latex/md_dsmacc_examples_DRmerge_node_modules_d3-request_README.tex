This module provides a convenient alternative to X\+M\+L\+Http\+Request. For example, to load a text file\+:


\begin{DoxyCode}
d3.text("/path/to/file.txt", function(error, text) \{
  if (error) throw error;
  console.log(text); // Hello, world!
\});
\end{DoxyCode}


To load and parse a C\+SV file\+:


\begin{DoxyCode}
d3.csv("/path/to/file.csv", function(error, data) \{
  if (error) throw error;
  console.log(data); // [\{"Hello": "world"\}, …]
\});
\end{DoxyCode}


To post some query parameters\+:


\begin{DoxyCode}
d3.request("/path/to/resource")
    .header("X-Requested-With", "XMLHttpRequest")
    .header("Content-Type", "application/x-www-form-urlencoded")
    .post("a=2&b=3", callback);
\end{DoxyCode}


This module has built-\/in support for parsing \href{#json}{\tt J\+S\+ON}, \href{#csv}{\tt C\+SV} and \href{#tsv}{\tt T\+SV}; in browsers, but not in \mbox{\hyperlink{classNode}{Node}}, \href{#html}{\tt H\+T\+ML} and \href{#xml}{\tt X\+ML} are also supported. You can parse additional formats by using \href{#request}{\tt request} or \href{#text}{\tt text} directly.

\subsection*{Installing}

If you use N\+PM, {\ttfamily npm install d3-\/request}. Otherwise, download the \href{https://github.com/d3/d3-request/releases/latest}{\tt latest release}. You can also load directly from \href{https://d3js.org}{\tt d3js.\+org}, either as a \href{https://d3js.org/d3-request.v1.min.js}{\tt standalone library} or as part of \href{https://github.com/d3/d3}{\tt D3 4.\+0}. A\+MD, Common\+JS, and vanilla environments are supported. In vanilla, a {\ttfamily d3} global is exported\+:


\begin{DoxyCode}
<script src="https://d3js.org/d3-collection.v1.min.js"></script>
<script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
<script src="https://d3js.org/d3-dsv.v1.min.js"></script>
<script src="https://d3js.org/d3-request.v1.min.js"></script>
<script>

d3.csv("/path/to/file.csv", callback);

</script>
\end{DoxyCode}


\href{https://tonicdev.com/npm/d3-request}{\tt Try d3-\/request in your browser.}

\subsection*{A\+PI Reference}

\label{_request}%
\# d3.{\bfseries request}({\itshape url}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L4}{\tt $<$$>$}

Returns a new {\itshape request} for specified {\itshape url}. If no {\itshape callback} is specified, the returned {\itshape request} is not yet \href{#request_send}{\tt sent} and can be further configured. If a {\itshape callback} is specified, it is equivalent to calling \href{#request_get}{\tt {\itshape request}.get} immediately after construction\+:


\begin{DoxyCode}
d3.request(url)
    .get(callback);
\end{DoxyCode}


If you wish to specify a request header or a mime type, you must {\itshape not} specify a callback to the constructor. Use \href{#request_header}{\tt {\itshape request}.header} or \href{#request_mimeType}{\tt {\itshape request}.mime\+Type} followed by \href{#request_get}{\tt {\itshape request}.get} instead. See \href{#json}{\tt d3.\+json}, \href{#csv}{\tt d3.\+csv}, \href{#tsv}{\tt d3.\+tsv}, \href{#html}{\tt d3.\+html} and \href{#xml}{\tt d3.\+xml} for content-\/specific convenience constructors.

\label{_request_header}%
\# {\itshape request}.{\bfseries header}({\itshape name}\mbox{[}, {\itshape value}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L51}{\tt $<$$>$}

If {\itshape value} is specified, sets the request header with the specified {\itshape name} to the specified value and returns this request instance. If {\itshape value} is null, removes the request header with the specified {\itshape name} instead. If {\itshape value} is not specified, returns the current value of the request header with the specified {\itshape name}. Header names are case-\/insensitive.

Request headers can only be modified before the request is \href{#request_send}{\tt sent}. Therefore, you cannot pass a callback to the \href{#request}{\tt request constructor} if you wish to specify a header; use \href{#request_get}{\tt {\itshape request}.get} or similar instead. For example\+:


\begin{DoxyCode}
d3.request(url)
    .header("Accept-Language", "en-US")
    .header("X-Requested-With", "XMLHttpRequest")
    .get(callback);
\end{DoxyCode}


Note\+: this library does not set the X-\/\+Requested-\/\+With header to {\ttfamily X\+M\+L\+Http\+Request} by default. Some servers require this header to mitigate unwanted requests, but the presence of the header triggers C\+O\+RS preflight checks; if necessary, set this header before sending the request.

\label{_request_mimeType}%
\# {\itshape request}.{\bfseries mime\+Type}(\mbox{[}{\itshape type}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L60}{\tt $<$$>$}

If {\itshape type} is specified, sets the request mime type to the specified value and returns this request instance. If {\itshape type} is null, clears the current mime type (if any) instead. If {\itshape type} is not specified, returns the current mime type, which defaults to null. The mime type is used to both set the \href{http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html}{\tt \char`\"{}\+Accept\char`\"{} request header} and for \href{http://www.w3.org/TR/XMLHttpRequest/#the-overridemimetype%28%29-method}{\tt override\+Mime\+Type}, where supported.

The request mime type can only be modified before the request is \href{#request_send}{\tt sent}. Therefore, you cannot pass a callback to the \href{#request}{\tt request constructor} if you wish to override the mime type; use \href{#request_get}{\tt {\itshape request}.get} or similar instead. For example\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/csv")
    .get(callback);
\end{DoxyCode}


\label{_request_user}%
\# {\itshape request}.{\bfseries user}(\mbox{[}{\itshape value}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L80}{\tt $<$$>$}

If {\itshape value} is specified, sets the user name for authentication to the specified string and returns this request instance. If {\itshape value} is not specified, returns the current user name, which defaults to null.

\label{_request_password}%
\# {\itshape request}.{\bfseries password}(\mbox{[}{\itshape value}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L84}{\tt $<$$>$}

If {\itshape value} is specified, sets the password for authentication to the specified string and returns this request instance. If {\itshape value} is not specified, returns the current password, which defaults to null.

\label{_request_timeout}%
\# {\itshape request}.{\bfseries timeout}(\mbox{[}{\itshape timeout}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L74}{\tt $<$$>$}

If {\itshape timeout} is specified, sets the \href{http://www.w3.org/TR/XMLHttpRequest/#the-timeout-attribute}{\tt timeout} attribute of the request to the specified number of milliseconds and returns this request instance. If {\itshape timeout} is not specified, returns the current response timeout, which defaults to 0.

\label{_request_responseType}%
\# {\itshape request}.{\bfseries response\+Type}(\mbox{[}{\itshape type}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L68}{\tt $<$$>$}

If {\itshape type} is specified, sets the \href{http://www.w3.org/TR/XMLHttpRequest/#the-responsetype-attribute}{\tt response type} attribute of the request and returns this request instance. Typical values are\+: {\ttfamily ​} (the empty string), {\ttfamily arraybuffer}, {\ttfamily blob}, {\ttfamily document}, and {\ttfamily text}. If {\itshape type} is not specified, returns the current response type, which defaults to {\ttfamily ​}.

\label{_request_response}%
\# {\itshape request}.{\bfseries response}({\itshape value}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L90}{\tt $<$$>$}

Sets the response value function to the specified function and returns this request instance. The response value function is used to map the response X\+M\+L\+Http\+Request object to a useful data value. See the convenience methods \href{#json}{\tt json} and \href{#text}{\tt text} for examples.

\label{_request_get}%
\# {\itshape request}.{\bfseries get}(\mbox{[}{\itshape data}\mbox{]}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L96}{\tt $<$$>$}

Equivalent to \href{#request_send}{\tt {\itshape request}.send} with the G\+ET method\+:


\begin{DoxyCode}
request.send("GET", data, callback);
\end{DoxyCode}


\label{_request_post}%
\# {\itshape request}.{\bfseries post}(\mbox{[}{\itshape data}\mbox{]}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L101}{\tt $<$$>$}

Equivalent to \href{#request_send}{\tt {\itshape request}.send} with the P\+O\+ST method\+:


\begin{DoxyCode}
request.send("POST", data, callback);
\end{DoxyCode}


\label{_request_send}%
\# {\itshape request}.{\bfseries send}({\itshape method}\mbox{[}, {\itshape data}\mbox{]}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L106}{\tt $<$$>$}

Issues this request using the specified {\itshape method} (such as {\ttfamily G\+ET} or {\ttfamily P\+O\+ST}), optionally posting the specified {\itshape data} in the request body, and returns this request instance. If a {\itshape callback} is specified, the callback will be invoked asynchronously when the request succeeds or fails. The callback is invoked with two arguments\+: the error, if any, and the \href{#request_response}{\tt response value}. The response value is undefined if an error occurs. This is equivalent to\+:


\begin{DoxyCode}
request
    .on("error", function(error) \{ callback(error); \})
    .on("load", function(xhr) \{ callback(null, xhr); \})
    .send(method, data);
\end{DoxyCode}


If no {\itshape callback} is specified, then \char`\"{}load\char`\"{} and \char`\"{}error\char`\"{} listeners should be registered via \href{#request_on}{\tt {\itshape request}.on}.

\label{_request_abort}%
\# {\itshape request}.{\bfseries abort}() \href{https://github.com/d3/d3-request/blob/master/src/request.js#L121}{\tt $<$$>$}

Aborts this request, if it is currently in-\/flight, and returns this request instance. See \href{http://www.w3.org/TR/XMLHttpRequest/#the-abort%28%29-method}{\tt X\+M\+L\+Http\+Request’s abort}.

\label{_request_on}%
\# {\itshape request}.{\bfseries on}({\itshape type}\mbox{[}, {\itshape listener}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/request.js#L126}{\tt $<$$>$}

If {\itshape listener} is specified, sets the event {\itshape listener} for the specified {\itshape type} and returns this request instance. If an event listener was already registered for the same type, the existing listener is removed before the new listener is added. If {\itshape listener} is null, removes the current event {\itshape listener} for the specified {\itshape type} (if any) instead. If {\itshape listener} is not specified, returns the currently-\/assigned listener for the specified type, if any.

The type must be one of the following\+:


\begin{DoxyItemize}
\item {\ttfamily beforesend} -\/ to allow custom headers and the like to be set before the request is \href{#request_send}{\tt sent}.
\item {\ttfamily progress} -\/ to monitor the \href{http://www.w3.org/TR/progress-events/}{\tt progress of the request}.
\item {\ttfamily load} -\/ when the request completes successfully.
\item {\ttfamily error} -\/ when the request completes unsuccessfully; this includes 4xx and 5xx response codes.
\end{DoxyItemize}

To register multiple listeners for the same {\itshape type}, the type may be followed by an optional name, such as {\ttfamily load.\+foo} and {\ttfamily load.\+bar}. See \href{https://github.com/d3/d3-dispatch}{\tt d3-\/dispatch} for details.

\label{_csv}%
\# d3.{\bfseries csv}({\itshape url}\mbox{[}\mbox{[}, {\itshape row}\mbox{]}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/csv.js}{\tt $<$$>$}

Returns a new \href{#request}{\tt {\itshape request}} for the \href{https://github.com/d3/d3-dsv#csvParse}{\tt C\+SV} file at the specified {\itshape url} with the default mime type {\ttfamily text/csv}. If no {\itshape callback} is specified, this is equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/csv")
    .response(function(xhr) \{ return d3.csvParse(xhr.responseText, row); \});
\end{DoxyCode}


If a {\itshape callback} is specified, a \href{#request_get}{\tt G\+ET} request is sent, making it equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/csv")
    .response(function(xhr) \{ return d3.csvParse(xhr.responseText, row); \})
    .get(callback);
\end{DoxyCode}


An optional {\itshape row} conversion function may be specified to map and filter row objects to a more-\/specific representation; see \href{https://github.com/d3/d3-dsv#dsv_parse}{\tt {\itshape dsv}.parse} for details. For example\+:


\begin{DoxyCode}
function row(d) \{
  return \{
    year: new Date(+d.Year, 0, 1), // convert "Year" column to Date
    make: d.Make,
    model: d.Model,
    length: +d.Length // convert "Length" column to number
  \};
\}
\end{DoxyCode}


The returned {\itshape request} exposes an additional {\itshape request}.row method as an alternative to passing the {\itshape row} conversion function to d3.\+csv, allowing you to configure the request before sending it. For example, this\+:


\begin{DoxyCode}
d3.csv(url, row, callback);
\end{DoxyCode}


Is equivalent to this\+:


\begin{DoxyCode}
d3.csv(url)
    .row(row)
    .get(callback);
\end{DoxyCode}


\label{_html}%
\# d3.{\bfseries html}({\itshape url}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/html.js}{\tt $<$$>$}

Returns a new \href{#request}{\tt {\itshape request}} for the H\+T\+ML file at the specified {\itshape url} with the default mime type {\ttfamily text/html}. The H\+T\+ML file is returned as a \href{https://developer.mozilla.org/en-US/docs/DOM/range.createContextualFragment}{\tt document fragment}. If no {\itshape callback} is specified, this is equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/html")
    .response(function(xhr) \{ return document.createRange().createContextualFragment(xhr.responseText); \});
\end{DoxyCode}


If a {\itshape callback} is specified, a \href{#request_get}{\tt G\+ET} request is sent, making it equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/html")
    .response(function(xhr) \{ return document.createRange().createContextualFragment(xhr.responseText); \})
    .get(callback);
\end{DoxyCode}


H\+T\+ML parsing requires a global document and relies on \href{https://dom.spec.whatwg.org/#ranges}{\tt D\+OM Ranges}, which are \href{https://github.com/tmpvar/jsdom/issues/317}{\tt not supported by J\+S\+D\+OM} as of version 8.\+3; thus, this method is supported in browsers but not in \mbox{\hyperlink{classNode}{Node}}.

\label{_json}%
\# d3.{\bfseries json}({\itshape url}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/json.js}{\tt $<$$>$}

Returns a new \href{#request}{\tt {\itshape request}} to \href{#request_get}{\tt get} the \href{http://json.org}{\tt J\+S\+ON} file at the specified {\itshape url} with the default mime type {\ttfamily application/json}. If no {\itshape callback} is specified, this is equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("application/json")
    .response(function(xhr) \{ return JSON.parse(xhr.responseText); \});
\end{DoxyCode}


If a {\itshape callback} is specified, a \href{#request_get}{\tt G\+ET} request is sent, making it equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("application/json")
    .response(function(xhr) \{ return JSON.parse(xhr.responseText); \})
    .get(callback);
\end{DoxyCode}


\label{_text}%
\# d3.{\bfseries text}({\itshape url}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/text.js}{\tt $<$$>$}

Returns a new \href{#request}{\tt {\itshape request}} to \href{#request_get}{\tt get} the text file at the specified {\itshape url} with the default mime type {\ttfamily text/plain}. If no {\itshape callback} is specified, this is equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/plain")
    .response(function(xhr) \{ return xhr.responseText; \});
\end{DoxyCode}


If a {\itshape callback} is specified, a \href{#request_get}{\tt G\+ET} request is sent, making it equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/plain")
    .response(function(xhr) \{ return xhr.responseText; \})
    .get(callback);
\end{DoxyCode}


\label{_tsv}%
\# d3.{\bfseries tsv}({\itshape url}\mbox{[}\mbox{[}, {\itshape row}\mbox{]}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/tsv.js}{\tt $<$$>$}

Returns a new \href{#request}{\tt {\itshape request}} for a \href{https://github.com/d3/d3-dsv#tsvParse}{\tt T\+SV} file at the specified {\itshape url} with the default mime type {\ttfamily text/tab-\/separated-\/values}. If no {\itshape callback} is specified, this is equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/tab-separated-values")
    .response(function(xhr) \{ return d3.tsvParse(xhr.responseText, row); \});
\end{DoxyCode}


If a {\itshape callback} is specified, a \href{#request_get}{\tt G\+ET} request is sent, making it equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("text/tab-separated-values")
    .response(function(xhr) \{ return d3.tsvParse(xhr.responseText, row); \})
    .get(callback);
\end{DoxyCode}


An optional {\itshape row} conversion function may be specified to map and filter row objects to a more-\/specific representation; see \href{https://github.com/d3/d3-dsv#dsv_parse}{\tt {\itshape dsv}.parse} for details. For example\+:


\begin{DoxyCode}
function row(d) \{
  return \{
    year: new Date(+d.Year, 0, 1), // convert "Year" column to Date
    make: d.Make,
    model: d.Model,
    length: +d.Length // convert "Length" column to number
  \};
\}
\end{DoxyCode}


The returned {\itshape request} exposes an additional {\itshape request}.row method as an alternative to passing the {\itshape row} conversion function to d3.\+tsv, allowing you to configure the request before sending it. For example, this\+:


\begin{DoxyCode}
d3.tsv(url, row, callback);
\end{DoxyCode}


Is equivalent to this\+:


\begin{DoxyCode}
d3.tsv(url)
    .row(row)
    .get(callback);
\end{DoxyCode}


\label{_xml}%
\# d3.{\bfseries xml}({\itshape url}\mbox{[}, {\itshape callback}\mbox{]}) \href{https://github.com/d3/d3-request/blob/master/src/xml.js}{\tt $<$$>$}

Returns a new \href{#request}{\tt {\itshape request}} to \href{#request_get}{\tt get} the X\+ML file at the specified {\itshape url} with the default mime type {\ttfamily application/xml}. If no {\itshape callback} is specified, this is equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("application/xml")
    .response(function(xhr) \{ return xhr.responseXML; \});
\end{DoxyCode}


If a {\itshape callback} is specified, a \href{#request_get}{\tt G\+ET} request is sent, making it equivalent to\+:


\begin{DoxyCode}
d3.request(url)
    .mimeType("application/xml")
    .response(function(xhr) \{ return xhr.responseXML; \})
    .get(callback);
\end{DoxyCode}


X\+ML parsing relies on \href{https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseXML}{\tt {\itshape xhr}.response\+X\+ML} which is not supported by \href{https://github.com/driverdan/node-XMLHttpRequest/issues/8}{\tt node-\/\+X\+M\+L\+Http\+Request} as of version 1.\+8; thus, this method is supported in browsers but not in \mbox{\hyperlink{classNode}{Node}}. 