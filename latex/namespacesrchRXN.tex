\hypertarget{namespacesrchRXN}{}\section{srch\+R\+XN Namespace Reference}
\label{namespacesrchRXN}\index{srch\+R\+XN@{srch\+R\+XN}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespacesrchRXN_a954f72527cf0bb8f711f715c6919a936}{retr\+R\+XN}} (duprxn)
\item 
def \mbox{\hyperlink{namespacesrchRXN_a6683edc21ab66d0a7ecf4ecb98a8fe5f}{fnd\+D\+R\+XN}} (dl, rl, fkpp)
\item 
def \mbox{\hyperlink{namespacesrchRXN_a0d86abe53fd006f2f6ec9ea9e613a017}{react}} (line)
\item 
def \mbox{\hyperlink{namespacesrchRXN_a2d5632f8f982579d62c5b03a0d172de6}{make\+D\+I\+CT}} (rrate, ldup, dl, dr)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}*******************
*                 *
* Library srchRXN *
*                 *
*******************

PURPOSE:
Find all duplicate reactions in kpp file from kpp warnings. Combine
all reaction rate constants as sum of individual constants (and
product for several entries of same kind) and return a dictionary
'rrate' with:
- key:      line number of first occurrence of duplicate reaction
- entry 0:  kpp line of first occurrence up to colon
            (excluding kinetic information)
- entry 1:  cominded rate constants/j values
- entry 2:  list of line numbers of all other occurrences of
            this duplicate reaction

FUNCTIONS:
- retrRXN
- fndDRXN
- react
- makeDICT

(see help on individual functions for more information)
\end{DoxyVerb}
 

\subsection{Function Documentation}
\mbox{\Hypertarget{namespacesrchRXN_a6683edc21ab66d0a7ecf4ecb98a8fe5f}\label{namespacesrchRXN_a6683edc21ab66d0a7ecf4ecb98a8fe5f}} 
\index{srch\+R\+XN@{srch\+R\+XN}!fnd\+D\+R\+XN@{fnd\+D\+R\+XN}}
\index{fnd\+D\+R\+XN@{fnd\+D\+R\+XN}!srch\+R\+XN@{srch\+R\+XN}}
\subsubsection{\texorpdfstring{fnd\+D\+R\+X\+N()}{fndDRXN()}}
{\footnotesize\ttfamily def srch\+R\+X\+N.\+fnd\+D\+R\+XN (\begin{DoxyParamCaption}\item[{}]{dl,  }\item[{}]{rl,  }\item[{}]{fkpp }\end{DoxyParamCaption})}

\begin{DoxyVerb}********************
*                  *
* Function fndDRXN *
*                  *
********************

PURPOSE:
    Find line numbers of duplicate entries from line number and equation
    numbers given in kpp warning.

NB:
    Line numbers differ from equation numbers due to comments/empty lines.

VARIABLES:

I/O:
    - rl:       index of line number of duplicate entry that is
                to be kept and modified (i.e. actual line number - 1)
    - dl:       index of line number of duplicate entry that is
                to be deleted (i.e. actual line number - 1)
    - fkpp:     path + name of kpp file retrieved from warnings
    - l:        counter for loop over lines in kpp file and return value
                of refined dr variable
    - ll:       list of all lines from kpp file

internal:
    - drxn/rrxn:array with educt and products of both duplicate entries
                to find the correct lines of the duplicate entries
\end{DoxyVerb}
 
\begin{DoxyCode}
124 \textcolor{keyword}{def }fndDRXN(dl, rl, fkpp):
125 
126     \textcolor{stringliteral}{"""}
127 \textcolor{stringliteral}{    ********************}
128 \textcolor{stringliteral}{    *                  *}
129 \textcolor{stringliteral}{    * Function fndDRXN *}
130 \textcolor{stringliteral}{    *                  *}
131 \textcolor{stringliteral}{    ********************}
132 \textcolor{stringliteral}{}
133 \textcolor{stringliteral}{    PURPOSE:}
134 \textcolor{stringliteral}{        Find line numbers of duplicate entries from line number and equation}
135 \textcolor{stringliteral}{        numbers given in kpp warning.}
136 \textcolor{stringliteral}{}
137 \textcolor{stringliteral}{    NB:}
138 \textcolor{stringliteral}{        Line numbers differ from equation numbers due to comments/empty lines.}
139 \textcolor{stringliteral}{}
140 \textcolor{stringliteral}{    VARIABLES:}
141 \textcolor{stringliteral}{}
142 \textcolor{stringliteral}{    I/O:}
143 \textcolor{stringliteral}{        - rl:       index of line number of duplicate entry that is}
144 \textcolor{stringliteral}{                    to be kept and modified (i.e. actual line number - 1)}
145 \textcolor{stringliteral}{        - dl:       index of line number of duplicate entry that is}
146 \textcolor{stringliteral}{                    to be deleted (i.e. actual line number - 1)}
147 \textcolor{stringliteral}{        - fkpp:     path + name of kpp file retrieved from warnings}
148 \textcolor{stringliteral}{        - l:        counter for loop over lines in kpp file and return value}
149 \textcolor{stringliteral}{                    of refined dr variable}
150 \textcolor{stringliteral}{        - ll:       list of all lines from kpp file}
151 \textcolor{stringliteral}{}
152 \textcolor{stringliteral}{    internal:}
153 \textcolor{stringliteral}{        - drxn/rrxn:array with educt and products of both duplicate entries}
154 \textcolor{stringliteral}{                    to find the correct lines of the duplicate entries}
155 \textcolor{stringliteral}{    """}
156 
157 \textcolor{comment}{# read all lines from kpp file}
158     with open(fkpp,\textcolor{stringliteral}{'rw'}) \textcolor{keyword}{as} f:
159         ll = f.readlines()
160 \textcolor{comment}{# find educts/products of second duplicate entry}
161         drxn = react(ll[dl])
162 
163 \textcolor{comment}{# find line number of first duplicate entry}
164 \textcolor{comment}{# search starts at line number of second duplicate entry retrieved from}
165 \textcolor{comment}{# kpp warning minus the equation number of second duplicate entry plus}
166 \textcolor{comment}{# the equation number of the first duplicate entry.}
167 \textcolor{comment}{# Due to empty/comment lines a loop has to be performed from the starting}
168 \textcolor{comment}{# line to the top of the file.}
169         \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} reversed(xrange(rl)):
170 \textcolor{comment}{# find educts/products of first duplicate entry}
171             rrxn = react(ll[l])
172 
173 \textcolor{comment}{# If educts/products are equal, exit loop and return loop index}
174 \textcolor{comment}{# as refined index for line number of first duplicate entry}
175             \textcolor{keywordflow}{if} drxn == rrxn:
176                 \textcolor{keywordflow}{break}
177     \textcolor{keywordflow}{return} l,ll
178 
\end{DoxyCode}
\mbox{\Hypertarget{namespacesrchRXN_a2d5632f8f982579d62c5b03a0d172de6}\label{namespacesrchRXN_a2d5632f8f982579d62c5b03a0d172de6}} 
\index{srch\+R\+XN@{srch\+R\+XN}!make\+D\+I\+CT@{make\+D\+I\+CT}}
\index{make\+D\+I\+CT@{make\+D\+I\+CT}!srch\+R\+XN@{srch\+R\+XN}}
\subsubsection{\texorpdfstring{make\+D\+I\+C\+T()}{makeDICT()}}
{\footnotesize\ttfamily def srch\+R\+X\+N.\+make\+D\+I\+CT (\begin{DoxyParamCaption}\item[{}]{rrate,  }\item[{}]{ldup,  }\item[{}]{dl,  }\item[{}]{dr }\end{DoxyParamCaption})}

\begin{DoxyVerb}*********************
*                   *
* Function makeDICT *
*                   *
*********************

PURPOSE:
    Generate dictionary with mechanistic and kinetic data of refined
    reaction from duplicate entries and retrieve line numbers of all
    duplicate entries.
    Dictionary 'rrate':
    - key:      line number of first occurrence of duplicate reaction
    - entry 0:  kpp line of first occurrence up to colon
                (excluding kinetic information)
    - entry 1:  cominded rate constants/j values
    - entry 2:  list of line numbers of all other occurrences of
                this duplicate reaction


VARIABLES:

I/O:
    - rrate:    dictionary with mechanistic and kinetic data of
                combined duplicate reactions and line numbers of
                all duplicate entries
    - ldup:     list of all lines from kpp file
    - dr:       index of line number of duplicate entry that is
                to be kept and modified (i.e. actual line number - 1)
    - dl:       index of line number of duplicate entry that is
                to be deleted (i.e. actual line number - 1)
\end{DoxyVerb}
 
\begin{DoxyCode}
225 \textcolor{keyword}{def }makeDICT(rrate, ldup, dl, dr):
226 
227     \textcolor{stringliteral}{"""}
228 \textcolor{stringliteral}{    *********************}
229 \textcolor{stringliteral}{    *                   *}
230 \textcolor{stringliteral}{    * Function makeDICT *}
231 \textcolor{stringliteral}{    *                   *}
232 \textcolor{stringliteral}{    *********************}
233 \textcolor{stringliteral}{}
234 \textcolor{stringliteral}{    PURPOSE:}
235 \textcolor{stringliteral}{        Generate dictionary with mechanistic and kinetic data of refined}
236 \textcolor{stringliteral}{        reaction from duplicate entries and retrieve line numbers of all}
237 \textcolor{stringliteral}{        duplicate entries.}
238 \textcolor{stringliteral}{        Dictionary 'rrate':}
239 \textcolor{stringliteral}{        - key:      line number of first occurrence of duplicate reaction}
240 \textcolor{stringliteral}{        - entry 0:  kpp line of first occurrence up to colon}
241 \textcolor{stringliteral}{                    (excluding kinetic information)}
242 \textcolor{stringliteral}{        - entry 1:  cominded rate constants/j values}
243 \textcolor{stringliteral}{        - entry 2:  list of line numbers of all other occurrences of}
244 \textcolor{stringliteral}{                    this duplicate reaction}
245 \textcolor{stringliteral}{}
246 \textcolor{stringliteral}{}
247 \textcolor{stringliteral}{    VARIABLES:}
248 \textcolor{stringliteral}{}
249 \textcolor{stringliteral}{    I/O:}
250 \textcolor{stringliteral}{        - rrate:    dictionary with mechanistic and kinetic data of}
251 \textcolor{stringliteral}{                    combined duplicate reactions and line numbers of}
252 \textcolor{stringliteral}{                    all duplicate entries}
253 \textcolor{stringliteral}{        - ldup:     list of all lines from kpp file}
254 \textcolor{stringliteral}{        - dr:       index of line number of duplicate entry that is}
255 \textcolor{stringliteral}{                    to be kept and modified (i.e. actual line number - 1)}
256 \textcolor{stringliteral}{        - dl:       index of line number of duplicate entry that is}
257 \textcolor{stringliteral}{                    to be deleted (i.e. actual line number - 1)}
258 \textcolor{stringliteral}{    """}
259 
260 \textcolor{comment}{# append existing key (i.e. already found first line number of duplicate reaction)}
261 \textcolor{comment}{# by line number and kinetic data of second (or further) duplicate entry}
262     \textcolor{keywordflow}{if} rrate.has\_key(dr):
263         rrate[dr][1].append(ldup[dl][ldup[dl].index(\textcolor{stringliteral}{':'})+1:ldup[dl].index(\textcolor{stringliteral}{';'})].strip())
264         rrate[dr][2].append(dl)
265     \textcolor{keywordflow}{else}:
266 \textcolor{comment}{# If no key found generate key using line number of first duplicate entry}
267 \textcolor{comment}{# and specify kinetic data of first and second entry as well as line number of second entry}
268         rrate[dr] = [ldup[dr][:ldup[dr].index(\textcolor{stringliteral}{':'})+1]]
269         rrate[dr].append([ldup[dr][ldup[dr].index(\textcolor{stringliteral}{':'})+1:ldup[dr].index(\textcolor{stringliteral}{';'})].strip()])
270         rrate[dr][1].append(ldup[dl][ldup[dl].index(\textcolor{stringliteral}{':'})+1:ldup[dl].index(\textcolor{stringliteral}{';'})].strip())
271         rrate[dr].append([dl])
272 
273     \textcolor{keywordflow}{return} rrate
274 
\end{DoxyCode}
\mbox{\Hypertarget{namespacesrchRXN_a0d86abe53fd006f2f6ec9ea9e613a017}\label{namespacesrchRXN_a0d86abe53fd006f2f6ec9ea9e613a017}} 
\index{srch\+R\+XN@{srch\+R\+XN}!react@{react}}
\index{react@{react}!srch\+R\+XN@{srch\+R\+XN}}
\subsubsection{\texorpdfstring{react()}{react()}}
{\footnotesize\ttfamily def srch\+R\+X\+N.\+react (\begin{DoxyParamCaption}\item[{}]{line }\end{DoxyParamCaption})}

\begin{DoxyVerb}******************
*                *
* Function react *
*                *
******************

PURPOSE:
    Retrieve all educts and products from from a kpp reaction.

NB:
    To find all duplicate reactions, educts and products have to be
    compared rather than comparing reaction strings directly as species
    can appear in different order in the duplicate reactions.
    Educt/product arrays are sorted for direct comparison.

VARIABLES:

I/O:
    line:   string of kpp line with reaction
    edct:   sorted array of all educts
    prod:   sorted array of all products

internal:
    e/p:    counter for loops over educts/products
\end{DoxyVerb}
 
\begin{DoxyCode}
181 \textcolor{keyword}{def }react(line):
182 
183     \textcolor{stringliteral}{"""}
184 \textcolor{stringliteral}{    ******************}
185 \textcolor{stringliteral}{    *                *}
186 \textcolor{stringliteral}{    * Function react *}
187 \textcolor{stringliteral}{    *                *}
188 \textcolor{stringliteral}{    ******************}
189 \textcolor{stringliteral}{}
190 \textcolor{stringliteral}{    PURPOSE:}
191 \textcolor{stringliteral}{        Retrieve all educts and products from from a kpp reaction.}
192 \textcolor{stringliteral}{}
193 \textcolor{stringliteral}{    NB:}
194 \textcolor{stringliteral}{        To find all duplicate reactions, educts and products have to be}
195 \textcolor{stringliteral}{        compared rather than comparing reaction strings directly as species}
196 \textcolor{stringliteral}{        can appear in different order in the duplicate reactions.}
197 \textcolor{stringliteral}{        Educt/product arrays are sorted for direct comparison.}
198 \textcolor{stringliteral}{}
199 \textcolor{stringliteral}{    VARIABLES:}
200 \textcolor{stringliteral}{}
201 \textcolor{stringliteral}{    I/O:}
202 \textcolor{stringliteral}{        line:   string of kpp line with reaction}
203 \textcolor{stringliteral}{        edct:   sorted array of all educts}
204 \textcolor{stringliteral}{        prod:   sorted array of all products}
205 \textcolor{stringliteral}{}
206 \textcolor{stringliteral}{    internal:}
207 \textcolor{stringliteral}{        e/p:    counter for loops over educts/products}
208 \textcolor{stringliteral}{    """}
209 
210 \textcolor{comment}{# Retrived string with mechanistic data of educts from kpp line}
211     \textcolor{keywordflow}{print} line
212     edct = line[line.index(\textcolor{stringliteral}{'\}'})+1:line.index(\textcolor{stringliteral}{'='})].split(\textcolor{stringliteral}{'+'})
213 \textcolor{comment}{# Split into separate educts using '+' as separator and sort list}
214     edct = sorted([e.strip() \textcolor{keywordflow}{for} e \textcolor{keywordflow}{in} edct])
215 \textcolor{comment}{# Retrived string with mechanistic data of products from kpp line}
216     prod = line[line.index(\textcolor{stringliteral}{'='})+1:line.index(\textcolor{stringliteral}{':'})].split(\textcolor{stringliteral}{'+'})
217 \textcolor{comment}{# Split into separate products using '+' as separator and sort list}
218     prod = sorted([p.strip() \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} prod])
219 
220 \textcolor{comment}{# return educt and product list}
221     \textcolor{keywordflow}{return} edct,prod
222 
\end{DoxyCode}
\mbox{\Hypertarget{namespacesrchRXN_a954f72527cf0bb8f711f715c6919a936}\label{namespacesrchRXN_a954f72527cf0bb8f711f715c6919a936}} 
\index{srch\+R\+XN@{srch\+R\+XN}!retr\+R\+XN@{retr\+R\+XN}}
\index{retr\+R\+XN@{retr\+R\+XN}!srch\+R\+XN@{srch\+R\+XN}}
\subsubsection{\texorpdfstring{retr\+R\+X\+N()}{retrRXN()}}
{\footnotesize\ttfamily def srch\+R\+X\+N.\+retr\+R\+XN (\begin{DoxyParamCaption}\item[{}]{duprxn }\end{DoxyParamCaption})}

\begin{DoxyVerb}********************
*                  *
* Function retrRXN *
*                  *
********************

PURPOSE:
    Retrieve line numbers of duplicate reactions in kpp file and
    generate dictionary rrate to return to main script rmDUPRXN.
    Also returns kpp file path + name needed to rewrite the re-
    fined kpp file.


DESCRIPTION:
    retrRXN splits kpp warnings from screen output into segments
    and retrieves information about, which kpp file was used, the
    line numbers of the duplicate reaction, and then generates the
    dictionary rrate with information about the mechanistic and
    kinetic data of the combined reactions and all line numbers
    of the duplicate entries.
    Script files have to be stored in a folder 1 level below main.
    The designated folder is AnalysisTools.


IMPORTED PYTHON LIBRARIES:
    - numpy (as np)


VARIABLES:

I/O:
    - duprxn:   list of kpp warnings about duplicate reactions
    - rrate:    dictionary with mechanistic and kinetic data of
                combined duplicate reactions and line numbers of
                all duplicate entries
    - fkpp:     path + name of kpp file retrieved from warnings

internal:
    - l:        index for loop over warning messages
    - spl:      tempary array with warnings split into segments
                separated by colon
    - dr:       index of line number of duplicate entry that is
                to be kept and modified (i.e. actual line number - 1)
    - dl:       index of line number of duplicate entry that is
                to be deleted (i.e. actual line number - 1)
    - RIND:     temporary memory of string with kpp equation
                numbers of duplicate entries from kpp warning
    - rxn:      array with reaction numbers of duplicate entries
                used to derive line numbers
    - i1/i2:    indices for string manipulation
    - ldup:     list of all lines from kpp file\end{DoxyVerb}
 
\begin{DoxyCode}
31 \textcolor{keyword}{def }retrRXN(duprxn):
32 
33     \textcolor{stringliteral}{"""}
34 \textcolor{stringliteral}{    ********************}
35 \textcolor{stringliteral}{    *                  *}
36 \textcolor{stringliteral}{    * Function retrRXN *}
37 \textcolor{stringliteral}{    *                  *}
38 \textcolor{stringliteral}{    ********************}
39 \textcolor{stringliteral}{}
40 \textcolor{stringliteral}{    PURPOSE:}
41 \textcolor{stringliteral}{        Retrieve line numbers of duplicate reactions in kpp file and}
42 \textcolor{stringliteral}{        generate dictionary rrate to return to main script rmDUPRXN.}
43 \textcolor{stringliteral}{        Also returns kpp file path + name needed to rewrite the re-}
44 \textcolor{stringliteral}{        fined kpp file.}
45 \textcolor{stringliteral}{}
46 \textcolor{stringliteral}{}
47 \textcolor{stringliteral}{    DESCRIPTION:}
48 \textcolor{stringliteral}{        retrRXN splits kpp warnings from screen output into segments}
49 \textcolor{stringliteral}{        and retrieves information about, which kpp file was used, the}
50 \textcolor{stringliteral}{        line numbers of the duplicate reaction, and then generates the}
51 \textcolor{stringliteral}{        dictionary rrate with information about the mechanistic and}
52 \textcolor{stringliteral}{        kinetic data of the combined reactions and all line numbers}
53 \textcolor{stringliteral}{        of the duplicate entries.}
54 \textcolor{stringliteral}{        Script files have to be stored in a folder 1 level below main.}
55 \textcolor{stringliteral}{        The designated folder is AnalysisTools.}
56 \textcolor{stringliteral}{}
57 \textcolor{stringliteral}{}
58 \textcolor{stringliteral}{    IMPORTED PYTHON LIBRARIES:}
59 \textcolor{stringliteral}{        - numpy (as np)}
60 \textcolor{stringliteral}{}
61 \textcolor{stringliteral}{}
62 \textcolor{stringliteral}{    VARIABLES:}
63 \textcolor{stringliteral}{}
64 \textcolor{stringliteral}{    I/O:}
65 \textcolor{stringliteral}{        - duprxn:   list of kpp warnings about duplicate reactions}
66 \textcolor{stringliteral}{        - rrate:    dictionary with mechanistic and kinetic data of}
67 \textcolor{stringliteral}{                    combined duplicate reactions and line numbers of}
68 \textcolor{stringliteral}{                    all duplicate entries}
69 \textcolor{stringliteral}{        - fkpp:     path + name of kpp file retrieved from warnings}
70 \textcolor{stringliteral}{}
71 \textcolor{stringliteral}{    internal:}
72 \textcolor{stringliteral}{        - l:        index for loop over warning messages}
73 \textcolor{stringliteral}{        - spl:      tempary array with warnings split into segments}
74 \textcolor{stringliteral}{                    separated by colon}
75 \textcolor{stringliteral}{        - dr:       index of line number of duplicate entry that is}
76 \textcolor{stringliteral}{                    to be kept and modified (i.e. actual line number - 1)}
77 \textcolor{stringliteral}{        - dl:       index of line number of duplicate entry that is}
78 \textcolor{stringliteral}{                    to be deleted (i.e. actual line number - 1)}
79 \textcolor{stringliteral}{        - RIND:     temporary memory of string with kpp equation}
80 \textcolor{stringliteral}{                    numbers of duplicate entries from kpp warning}
81 \textcolor{stringliteral}{        - rxn:      array with reaction numbers of duplicate entries}
82 \textcolor{stringliteral}{                    used to derive line numbers}
83 \textcolor{stringliteral}{        - i1/i2:    indices for string manipulation}
84 \textcolor{stringliteral}{        - ldup:     list of all lines from kpp file}
85 \textcolor{stringliteral}{}
86 \textcolor{stringliteral}{    """}
87 
88 \textcolor{comment}{# Import python functions}
89     \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np
90 
91 \textcolor{comment}{# Initialise dictionary}
92     rrate  = \{\}
93 
94 \textcolor{comment}{# Loop over all kpp warnings about duplicate reactions}
95     \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} range(len(duprxn)):
96 
97 \textcolor{comment}{# Retrieve information about equation/line numbers and file path/name}
98 \textcolor{comment}{# from warning messages}
99         spl = duprxn[l].split(\textcolor{stringliteral}{':'})
100         fkpp = \textcolor{stringliteral}{'.'}+spl[1].lstrip()
101         dl = int(spl[2])-1
102         RIND = spl[4]
103         rxn = np.empty(2,int)
104         i1 = RIND.index(\textcolor{stringliteral}{'<'})+1
105         i2 = RIND.index(\textcolor{stringliteral}{'>'})
106         rxn[0] = RIND[i1:i2]
107         i1 = RIND.index(\textcolor{stringliteral}{'<'},RIND.index(\textcolor{stringliteral}{'='}))+1
108         i2 = RIND.index(\textcolor{stringliteral}{'>'},RIND.index(\textcolor{stringliteral}{'='}))
109         rxn[1] = RIND[i1:i2]
110 
111 \textcolor{comment}{# Find line numbers of duplicate reactions from kpp warnings and}
112 \textcolor{comment}{# search same educts products in kpp file and store all lines}
113 \textcolor{comment}{# from kpp file}
114         dr, ldup = fndDRXN(dl, dl+1+rxn[0]-rxn[1], fkpp)
115 
116 \textcolor{comment}{# Generate and return dictionary with mechanistic and kinetic}
117 \textcolor{comment}{# data of combined reactions and line numbers of duplicate entries}
118         rrate = makeDICT(rrate, ldup, dl, dr)
119 
120     \textcolor{keywordflow}{return} rrate, fkpp
121 
\end{DoxyCode}
