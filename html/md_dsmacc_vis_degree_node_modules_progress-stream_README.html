<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DSMACC: progress-stream</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DSMACC
   &#160;<span id="projectnumber">2019</span>
   </div>
   <div id="projectbrief">Changes to DSMACC for the thesis of Daniel Ellis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">progress-stream </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Read the progress of a stream. Supports speed and eta.</p>
<p>Gets the lengths of the stream automatically if you're using the request or http module. You can also pass the length on initiation. Progress-stream will also check to see if the stream already have a length property. </p><pre class="fragment">npm install progress-stream
</pre><h2>Usage</h2>
<p>This example copies a large file, and prints out the percentage, speed and remaining every 100ms.</p>
<div class="fragment"><div class="line">var progress = require(&#39;progress-stream&#39;);</div><div class="line">var fs = require(&#39;fs&#39;);</div><div class="line"></div><div class="line">var stat = fs.statSync(filename);</div><div class="line">var str = progress({</div><div class="line">    length: stat.size,</div><div class="line">    time: 100</div><div class="line">});</div><div class="line"></div><div class="line">str.on(&#39;progress&#39;, function(progress) {</div><div class="line">    console.log(progress);</div><div class="line"></div><div class="line">    /*</div><div class="line">    {</div><div class="line">        percentage: 9.05,</div><div class="line">        transferred: 949624,</div><div class="line">        length: 10485760,</div><div class="line">        remaining: 9536136,</div><div class="line">        eta: 42,</div><div class="line">        runtime: 3,</div><div class="line">        delta: 295396,</div><div class="line">        speed: 949624</div><div class="line">    }</div><div class="line">    */</div><div class="line">});</div><div class="line"></div><div class="line">fs.createReadStream(filename)</div><div class="line">    .pipe(str)</div><div class="line">    .pipe(fs.createWriteStream(output));</div></div><!-- fragment --><h2>Methods</h2>
<h3>progress([options], [onprogress])</h3>
<p>You can instantiate in two ways:</p>
<div class="fragment"><div class="line">var str = progress({time:100});</div><div class="line">str.on(&#39;progress&#39;, function(progress) { ... });</div></div><!-- fragment --><p>or inline the progress listener</p>
<div class="fragment"><div class="line">var str = progress({time:100}, function(progress) { ... });</div></div><!-- fragment --><h2>Properties</h2>
<h3>.progress</h3>
<p>You can get the progress from the progress property.</p>
<div class="fragment"><div class="line">var str = progress({time:100});</div><div class="line"></div><div class="line">console.log(str.progress);</div><div class="line"></div><div class="line">/*</div><div class="line">{</div><div class="line">    percentage: 9.05,</div><div class="line">    transferred: 949624,</div><div class="line">    length: 10485760,</div><div class="line">    remaining: 9536136,</div><div class="line">    eta: 10,</div><div class="line">    runtime: 0,</div><div class="line">    delta: 295396,</div><div class="line">    speed: 949624</div><div class="line">}</div><div class="line">*/</div></div><!-- fragment --><h2>Events</h2>
<h3>on('progress', function(progress) { ... })</h3>
<div class="fragment"><div class="line">var str = progress({time:100});</div><div class="line">str.on(&#39;progress&#39;, function(progress) { ... });</div></div><!-- fragment --><h2>Options</h2>
<h3>time(integer)</h3>
<p>Sets how often progress events is emitted. If omitted then defaults to emit every time a chunk is received.</p>
<h3>speed(integer)</h3>
<p>Sets how long the speedometer needs to calculate the speed. Defaults to 5 sec.</p>
<h3>length(integer)</h3>
<p>If you already know the length of the stream, then you can set it. Defaults to 0.</p>
<h3>drain(boolean)</h3>
<p>In case you don't want to include a readstream after progress-stream, set to true to drain automatically. Defaults to false.</p>
<h3>transferred(integer)</h3>
<p>If you want to set how much data have previous been downloaded. Useful for a resumed download.</p>
<h2>Examples</h2>
<h3>Using the request module</h3>
<p>This example uses request to download a 100 MB file, and writes out the percentage every second.</p>
<p>You can also find an example in <code>test/request.js</code>.</p>
<div class="fragment"><div class="line">var progress = require(&#39;progress-stream&#39;);</div><div class="line">var req = require(&#39;request&#39;);</div><div class="line">var fs = require(&#39;fs&#39;);</div><div class="line"></div><div class="line">var str = progress({</div><div class="line">    time: 1000</div><div class="line">});</div><div class="line"></div><div class="line">str.on(&#39;progress&#39;, function(progress) {</div><div class="line">    console.log(Math.round(progress.percentage)+&#39;%&#39;);</div><div class="line">});</div><div class="line"></div><div class="line">req(&#39;http://cachefly.cachefly.net/100mb.test&#39;, { headers: { &#39;user-agent&#39;: &#39;test&#39; }})</div><div class="line">    .pipe(str)</div><div class="line">    .pipe(fs.createWriteStream(&#39;test.data&#39;));</div></div><!-- fragment --><h3>Using the http module</h3>
<p>In <code>test/http.js</code> it's shown how to do it with the http module.</p>
<h2>Methods</h2>
<h3><code>setLength(newLength)</code></h3>
<p>Sometimes, you don't know how big a stream is right away (e.g. multipart file uploads). You might find out after a few chunks have already passed through the stream, seconds or even minutes later. In this case, you can use the <code>setLength</code> method to recalculate the relevant tracked progress data.</p>
<div class="fragment"><div class="line">var str = progress({});</div><div class="line">someFickleStreamInstance.pipe(str).pipe(fs.createWriteStream(&#39;test.data&#39;));</div><div class="line"></div><div class="line">someFickleStreamInstance.on(&#39;conviction&#39;, function nowIKnowMyLength (actualLength) {</div><div class="line">  str.setLength(actualLength);</div><div class="line">});</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
