<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DSMACC: An example of how to view DSMACC results</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DSMACC
   &#160;<span id="projectnumber">2019</span>
   </div>
   <div id="projectbrief">Changes to DSMACC for the thesis of Daniel Ellis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">An example of how to view DSMACC results </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Firstly start by importing the provided library from the main DSMACC directory.</p>
<div class="fragment"><div class="line">%matplotlib inline </div><div class="line"># above only needed for Jupyter notebooks </div><div class="line"></div><div class="line">import dsmacc</div></div><!-- fragment --> <pre class="fragment">loading libraries
ready
</pre><h4>For each NetCDF file, we can select a run and create an object that contains its data</h4>
<p>The <code>new</code> class may be given arguments for a filename or groupid (index number of the required group should we not require interactive selection.</p>
<div class="fragment"><div class="line">example_file = dsmacc.new()</div></div><!-- fragment --> <pre class="fragment">Select file to open: 

0  -  methane_1707051607.nc
1  -  methane_1707051609.nc
Enter Number 
1
methane took 58 seconds to compute.
</pre><h4>Should we forget our selection we are able to draw this information out again</h4>
<div class="fragment"><div class="line">print &#39;Filename selected: %s&#39;%example_file.filename</div><div class="line">print &#39;Date: %s&#39;%example_file.date</div><div class="line">print &#39;Group: %s&#39;%example_file.group</div><div class="line">print example_file.description</div></div><!-- fragment --> <pre class="fragment">Filename selected: methane_1707051609.nc
Date: Completion time:Wednesday 05 July 2017 at 16:09
Group: methane
Description: Optional,Do not write time more than once. ,,
</pre><h4>Our species and rates are saved as a pandas dataframe</h4>
<div class="fragment"><div class="line">print &#39;Species:\n %s\n&#39;%example_file.specs[&#39;CH4&#39;].head()</div><div class="line">print &#39;Rates:\n %s&#39;%example_file.rates[&#39;CL+CH4--&gt;CH3O2&#39;].head()</div></div><!-- fragment --> <pre class="fragment">Species:
 TIME
1970-06-23 00:10:00    2.000000e-08
1970-06-23 00:20:00    2.000000e-08
1970-06-23 00:30:00    2.000000e-08
1970-06-23 00:40:00    2.000000e-08
1970-06-23 00:50:00    2.000000e-08
Name: CH4, dtype: float64

Rates:
 TIME
1970-06-23 00:10:00    1.028993e-13
1970-06-23 00:20:00    1.028993e-13
1970-06-23 00:30:00    1.028993e-13
1970-06-23 00:40:00    1.028993e-13
1970-06-23 00:50:00    1.028993e-13
Name: CL+CH4--&gt;CH3O2, dtype: float64
</pre><h4>Species names and rates can be extracted from the pandas dataframes or using <code>.snames</code> and <code>.rnames</code></h4>
<p>Since these only contain reactions or concentrations &gt; 0, we can also look at those with <code>.noconc</code> and <code>.norate</code></p>
<div class="fragment"><div class="line">#view the first 4 of each group</div><div class="line">print &#39;\n spec columns: &#39;+ &#39; &#39;.join(example_file.snames[:4])</div><div class="line">print &#39;\n rate columns: &#39;+ &#39; &#39;.join(example_file.rnames[:4])</div><div class="line">print &#39;\n ommited specs: &#39;+ &#39; &#39;.join(example_file.noconc[:4])</div><div class="line">print &#39;\n ommited rates: &#39;+ &#39; &#39;.join(example_file.norate[:4])</div></div><!-- fragment --><pre class="fragment"> spec columns: RO2 NA CO2 O1D

 rate columns: CL+CH4--&gt;CH3O2 CH4+OH--&gt;CH3O2 CH3O2+HO2--&gt;CH3OOH CH3O2+HO2--&gt;HCHO

 ommited specs: HSO3 SO3 SA CL

 ommited rates: EMISS--&gt;EMISS CH3O2+NO--&gt;CH3NO3 CH3O2+NO3--&gt;CH3O+NO2 HCHO+NO3--&gt;CO+HNO3+HO2
</pre><h4>For quick plotting we can use the <code>.plot</code> function with one or more species.</h4>
<p>This has an optional <code>what</code> argument that may be either specs or rates</p>
<div class="fragment"><div class="line">example_file.plot([&#39;NO&#39;,&#39;NO2&#39;],what=&#39;specs&#39;)</div></div><!-- fragment --><div class="image">
<img src="img/output_11_0.png" alt="png"/>
</div>
<h4>For full diagnostics we can use <code>.pdfdiagnostics</code>.</h4>
<p>This has a <code>what</code> argument that may be either specs or rates, and a <code>n_subplot</code> argument which corresponds to the number of subplots per page of the pdf</p>
<div class="fragment"><div class="line">example_file.pdfdiagnostics(what=&#39;specs&#39;,n_subplot = 5)</div></div><!-- fragment --> <pre class="fragment">creating a diagnostic pdf of specs
0.000 % done
0.250 % done
0.500 % done
0.750 % done
PDF out
</pre><h4>Example Section of an nheptane simulation pdf</h4>
<div class="image">
<img src="img/pdfdiagnostics.png" alt=" Example Section of an earlier pdf"/>
</div>
<h4>Finally the flux array may be calculated</h4>
<p>Where <code>example_file.flux</code> is the flux matrix</p>
<div class="fragment"><div class="line">example_file.ropa()</div><div class="line">example_file.flux</div></div><!-- fragment --> <pre class="fragment">running the ropacode





array([[  0.00000000e+000,   0.00000000e+000,   0.00000000e+000, ...,
          0.00000000e+000,   0.00000000e+000,   0.00000000e+000],
       [  0.00000000e+000,   0.00000000e+000,   0.00000000e+000, ...,
          0.00000000e+000,   0.00000000e+000,   0.00000000e+000],
       [  0.00000000e+000,   0.00000000e+000,   0.00000000e+000, ...,
          0.00000000e+000,   0.00000000e+000,   0.00000000e+000],
       ..., 
       [  0.00000000e+000,   4.91510929e-059,   3.70568330e-126, ...,
         -0.00000000e+000,   0.00000000e+000,   0.00000000e+000],
       [  0.00000000e+000,   1.09788928e-061,   1.84892377e-131, ...,
         -0.00000000e+000,   0.00000000e+000,   0.00000000e+000],
       [  0.00000000e+000,   2.45235823e-064,   9.22507088e-137, ...,
         -0.00000000e+000,   0.00000000e+000,   0.00000000e+000]])
</pre><h4>. . . or alternatively a ropa NetCDF file may be created and dragged into the link given for an interactive analysis</h4>
<div class="fragment"><div class="line">example_file.d3ropatool()</div></div><!-- fragment --> <pre class="fragment">making an NCFILE for the online tool: 
www-users.york.ac.uk/~dp626/MCMtools/dsmaccropa

running the ropacode
no concentration for u'CH3OOH'
no concentration for u'DUMMY'
no concentration for u'CH3OOH'
no concentration for u'CH3O2'
no concentration for u'CH3O2'
no concentration for u'CO'
no concentration for u'SO3'
no concentration for u'CH3OH'
no concentration for u'CH3O2'
no concentration for u'CH3OOH'
no concentration for u'CH3O'
no concentration for u'CH3OH'
no concentration for u'CH3NO3'
no concentration for u'CO'
no concentration for u'DUMMY'
no concentration for u'CO'
no concentration for u'DUMMY'
no concentration for u'DUMMY'
no concentration for u'CH3OH'
no concentration for u'CH3OOH'
list index out of range [u'NO2']
no concentration for u'CH3NO3'
no concentration for u'CH3O'
no concentration for u'CH3O2'
no concentration for u'CO'
no concentration for u'CH3O2NO2'
no concentration for u'HSO3'
list index out of range [u'OH']
no concentration for u'CH3O'
no concentration for u'CH3OOH'
no concentration for u'CH3O2'
no concentration for u'CH3O2'
no concentration for u'CH3O2NO2'
no concentration for u'CH3NO3'
nc write
</pre><h4>www-users.york.ac.uk/~dp626/MCMtools/dsmaccropa shows the following format.</h4>
<div class="image">
<img src="img/multiropa.gif" alt="Alt Text"/>
</div>
<h5>Mechanism or species comparison</h5>
<div class="fragment"><div class="line"># selection which only exists in one group or another </div><div class="line">example_file.symdiff(   other_examplefile , what=&#39;specs&#39;)</div><div class="line"></div><div class="line">#selection that exists in both groups</div><div class="line">example_file.intersect( other_examplefile , what=&#39;rates&#39;)</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
