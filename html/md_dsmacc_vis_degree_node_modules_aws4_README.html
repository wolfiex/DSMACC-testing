<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DSMACC: aws4</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DSMACC
   &#160;<span id="projectnumber">2019</span>
   </div>
   <div id="projectbrief">Changes to DSMACC for the thesis of Daniel Ellis</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">aws4 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://travis-ci.org/mhart/aws4"></a></p>
<p>A small utility to sign vanilla node.js http(s) request options using Amazon's <a href="http://docs.amazonwebservices.com/general/latest/gr/signature-version-4.html">AWS Signature Version 4</a>.</p>
<p>Can also be used <a href="./browser">in the browser</a>.</p>
<p>This signature is supported by nearly all Amazon services, including <a href="http://docs.aws.amazon.com/AmazonS3/latest/API/">S3</a>, <a href="http://docs.aws.amazon.com/AWSEC2/latest/APIReference/">EC2</a>, <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/API.html">DynamoDB</a>, <a href="http://docs.aws.amazon.com/kinesis/latest/APIReference/">Kinesis</a>, <a href="http://docs.aws.amazon.com/lambda/latest/dg/API_Reference.html">Lambda</a>, <a href="http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/">SQS</a>, <a href="http://docs.aws.amazon.com/sns/latest/api/">SNS</a>, <a href="http://docs.aws.amazon.com/IAM/latest/APIReference/">IAM</a>, <a href="http://docs.aws.amazon.com/STS/latest/APIReference/">STS</a>, <a href="http://docs.aws.amazon.com/AmazonRDS/latest/APIReference/">RDS</a>, <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/">CloudWatch</a>, <a href="http://docs.aws.amazon.com/AmazonCloudWatchLogs/latest/APIReference/">CloudWatch Logs</a>, <a href="http://docs.aws.amazon.com/codedeploy/latest/APIReference/">CodeDeploy</a>, <a href="http://docs.aws.amazon.com/AmazonCloudFront/latest/APIReference/">CloudFront</a>, <a href="http://docs.aws.amazon.com/awscloudtrail/latest/APIReference/">CloudTrail</a>, <a href="http://docs.aws.amazon.com/AmazonElastiCache/latest/APIReference/">ElastiCache</a>, <a href="http://docs.aws.amazon.com/ElasticMapReduce/latest/API/">EMR</a>, <a href="http://docs.aws.amazon.com/amazonglacier/latest/dev/amazon-glacier-api.html">Glacier</a>, <a href="http://docs.aws.amazon.com/cloudsearch/latest/developerguide/APIReq.html">CloudSearch</a>, <a href="http://docs.aws.amazon.com/ElasticLoadBalancing/latest/APIReference/">Elastic Load Balancing</a>, <a href="http://docs.aws.amazon.com/elastictranscoder/latest/developerguide/api-reference.html">Elastic Transcoder</a>, <a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/APIReference/">CloudFormation</a>, <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/api/">Elastic Beanstalk</a>, <a href="http://docs.aws.amazon.com/storagegateway/latest/userguide/AWSStorageGatewayAPI.html">Storage Gateway</a>, <a href="http://docs.aws.amazon.com/datapipeline/latest/APIReference/">Data Pipeline</a>, <a href="http://docs.aws.amazon.com/directconnect/latest/APIReference/">Direct Connect</a>, <a href="http://docs.aws.amazon.com/redshift/latest/APIReference/">Redshift</a>, <a href="http://docs.aws.amazon.com/opsworks/latest/APIReference/">OpsWorks</a>, <a href="http://docs.aws.amazon.com/ses/latest/APIReference/">SES</a>, <a href="http://docs.aws.amazon.com/amazonswf/latest/apireference/">SWF</a>, <a href="http://docs.aws.amazon.com/AutoScaling/latest/APIReference/">AutoScaling</a>, <a href="http://docs.aws.amazon.com/mobileanalytics/latest/ug/server-reference.html">Mobile Analytics</a>, <a href="http://docs.aws.amazon.com/cognitoidentity/latest/APIReference/">Cognito Identity</a>, <a href="http://docs.aws.amazon.com/cognitosync/latest/APIReference/">Cognito Sync</a>, <a href="http://docs.aws.amazon.com/AmazonECS/latest/APIReference/">Container Service</a>, <a href="http://docs.aws.amazon.com/appstream/latest/developerguide/appstream-api-rest.html">AppStream</a>, <a href="http://docs.aws.amazon.com/kms/latest/APIReference/">Key Management Service</a>, <a href="http://docs.aws.amazon.com/config/latest/APIReference/">Config</a>, <a href="http://docs.aws.amazon.com/cloudhsm/latest/dg/api-ref.html">CloudHSM</a>, <a href="http://docs.aws.amazon.com/Route53/latest/APIReference/requests-rest.html">Route53</a> and <a href="http://docs.aws.amazon.com/Route53/latest/APIReference/requests-rpc.html">Route53 Domains</a>.</p>
<p>Indeed, the only AWS services that <em>don't</em> support v4 as of 2014-12-30 are <a href="http://docs.aws.amazon.com/AWSImportExport/latest/DG/api-reference.html">Import/Export</a> and <a href="http://docs.aws.amazon.com/AmazonSimpleDB/latest/DeveloperGuide/SDB_API.html">SimpleDB</a> (they only support <a href="https://github.com/mhart/aws2">AWS Signature Version 2</a>).</p>
<p>It also provides defaults for a number of core AWS headers and request parameters, making it very easy to query AWS services, or build out a fully-featured AWS library.</p>
<h2>Example </h2>
<div class="fragment"><div class="line">var http  = require(&#39;http&#39;),</div><div class="line">    https = require(&#39;https&#39;),</div><div class="line">    aws4  = require(&#39;aws4&#39;)</div><div class="line"></div><div class="line">// given an options object you could pass to http.request</div><div class="line">var opts = {host: &#39;sqs.us-east-1.amazonaws.com&#39;, path: &#39;/?Action=ListQueues&#39;}</div><div class="line"></div><div class="line">// alternatively (as aws4 can infer the host):</div><div class="line">opts = {service: &#39;sqs&#39;, region: &#39;us-east-1&#39;, path: &#39;/?Action=ListQueues&#39;}</div><div class="line"></div><div class="line">// alternatively (as us-east-1 is default):</div><div class="line">opts = {service: &#39;sqs&#39;, path: &#39;/?Action=ListQueues&#39;}</div><div class="line"></div><div class="line">aws4.sign(opts) // assumes AWS credentials are available in process.env</div><div class="line"></div><div class="line">console.log(opts)</div><div class="line">/*</div><div class="line">{</div><div class="line">  host: &#39;sqs.us-east-1.amazonaws.com&#39;,</div><div class="line">  path: &#39;/?Action=ListQueues&#39;,</div><div class="line">  headers: {</div><div class="line">    Host: &#39;sqs.us-east-1.amazonaws.com&#39;,</div><div class="line">    &#39;X-Amz-Date&#39;: &#39;20121226T061030Z&#39;,</div><div class="line">    Authorization: &#39;AWS4-HMAC-SHA256 Credential=ABCDEF/20121226/us-east-1/sqs/aws4_request, ...&#39;</div><div class="line">  }</div><div class="line">}</div><div class="line">*/</div><div class="line"></div><div class="line">// we can now use this to query AWS using the standard node.js http API</div><div class="line">http.request(opts, function(res) { res.pipe(process.stdout) }).end()</div><div class="line">/*</div><div class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</div><div class="line">&lt;ListQueuesResponse xmlns=&quot;http://queue.amazonaws.com/doc/2012-11-05/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div></div><!-- fragment --><h2>More options </h2>
<div class="fragment"><div class="line">// you can also pass AWS credentials in explicitly (otherwise taken from process.env)</div><div class="line">aws4.sign(opts, {accessKeyId: &#39;&#39;, secretAccessKey: &#39;&#39;})</div><div class="line"></div><div class="line">// can also add the signature to query strings</div><div class="line">aws4.sign({service: &#39;s3&#39;, path: &#39;/my-bucket?X-Amz-Expires=12345&#39;, signQuery: true})</div><div class="line"></div><div class="line">// create a utility function to pipe to stdout (with https this time)</div><div class="line">function request(o) { https.request(o, function(res) { res.pipe(process.stdout) }).end(o.body || &#39;&#39;) }</div><div class="line"></div><div class="line">// aws4 can infer the HTTP method if a body is passed in</div><div class="line">// method will be POST and Content-Type: &#39;application/x-www-form-urlencoded; charset=utf-8&#39;</div><div class="line">request(aws4.sign({service: &#39;iam&#39;, body: &#39;Action=ListGroups&amp;Version=2010-05-08&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListGroupsResponse xmlns=&quot;https://iam.amazonaws.com/doc/2010-05-08/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">// can specify any custom option or header as per usual</div><div class="line">request(aws4.sign({</div><div class="line">  service: &#39;dynamodb&#39;,</div><div class="line">  region: &#39;ap-southeast-2&#39;,</div><div class="line">  method: &#39;POST&#39;,</div><div class="line">  path: &#39;/&#39;,</div><div class="line">  headers: {</div><div class="line">    &#39;Content-Type&#39;: &#39;application/x-amz-json-1.0&#39;,</div><div class="line">    &#39;X-Amz-Target&#39;: &#39;DynamoDB_20120810.ListTables&#39;</div><div class="line">  },</div><div class="line">  body: &#39;{}&#39;</div><div class="line">}))</div><div class="line">/*</div><div class="line">{&quot;TableNames&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">// works with all other services that support Signature Version 4</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;s3&#39;, path: &#39;/&#39;, signQuery: true}))</div><div class="line">/*</div><div class="line">&lt;ListAllMyBucketsResult xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;ec2&#39;, path: &#39;/?Action=DescribeRegions&amp;Version=2014-06-15&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeRegionsResponse xmlns=&quot;http://ec2.amazonaws.com/doc/2014-06-15/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;sns&#39;, path: &#39;/?Action=ListTopics&amp;Version=2010-03-31&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListTopicsResponse xmlns=&quot;http://sns.amazonaws.com/doc/2010-03-31/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;sts&#39;, path: &#39;/?Action=GetSessionToken&amp;Version=2011-06-15&#39;}))</div><div class="line">/*</div><div class="line">&lt;GetSessionTokenResponse xmlns=&quot;https://sts.amazonaws.com/doc/2011-06-15/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;cloudsearch&#39;, path: &#39;/?Action=ListDomainNames&amp;Version=2013-01-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListDomainNamesResponse xmlns=&quot;http://cloudsearch.amazonaws.com/doc/2013-01-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;ses&#39;, path: &#39;/?Action=ListIdentities&amp;Version=2010-12-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListIdentitiesResponse xmlns=&quot;http://ses.amazonaws.com/doc/2010-12-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;autoscaling&#39;, path: &#39;/?Action=DescribeAutoScalingInstances&amp;Version=2011-01-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeAutoScalingInstancesResponse xmlns=&quot;http://autoscaling.amazonaws.com/doc/2011-01-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;elasticloadbalancing&#39;, path: &#39;/?Action=DescribeLoadBalancers&amp;Version=2012-06-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeLoadBalancersResponse xmlns=&quot;http://elasticloadbalancing.amazonaws.com/doc/2012-06-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;cloudformation&#39;, path: &#39;/?Action=ListStacks&amp;Version=2010-05-15&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListStacksResponse xmlns=&quot;http://cloudformation.amazonaws.com/doc/2010-05-15/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;elasticbeanstalk&#39;, path: &#39;/?Action=ListAvailableSolutionStacks&amp;Version=2010-12-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListAvailableSolutionStacksResponse xmlns=&quot;http://elasticbeanstalk.amazonaws.com/docs/2010-12-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;rds&#39;, path: &#39;/?Action=DescribeDBInstances&amp;Version=2012-09-17&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeDBInstancesResponse xmlns=&quot;http://rds.amazonaws.com/doc/2012-09-17/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;monitoring&#39;, path: &#39;/?Action=ListMetrics&amp;Version=2010-08-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListMetricsResponse xmlns=&quot;http://monitoring.amazonaws.com/doc/2010-08-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;redshift&#39;, path: &#39;/?Action=DescribeClusters&amp;Version=2012-12-01&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeClustersResponse xmlns=&quot;http://redshift.amazonaws.com/doc/2012-12-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;cloudfront&#39;, path: &#39;/2014-05-31/distribution&#39;}))</div><div class="line">/*</div><div class="line">&lt;DistributionList xmlns=&quot;http://cloudfront.amazonaws.com/doc/2014-05-31/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;elasticache&#39;, path: &#39;/?Action=DescribeCacheClusters&amp;Version=2014-07-15&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeCacheClustersResponse xmlns=&quot;http://elasticache.amazonaws.com/doc/2014-07-15/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;elasticmapreduce&#39;, path: &#39;/?Action=DescribeJobFlows&amp;Version=2009-03-31&#39;}))</div><div class="line">/*</div><div class="line">&lt;DescribeJobFlowsResponse xmlns=&quot;http://elasticmapreduce.amazonaws.com/doc/2009-03-31&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;route53&#39;, path: &#39;/2013-04-01/hostedzone&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListHostedZonesResponse xmlns=&quot;https://route53.amazonaws.com/doc/2013-04-01/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;appstream&#39;, path: &#39;/applications&#39;}))</div><div class="line">/*</div><div class="line">{&quot;_links&quot;:{&quot;curie&quot;:[{&quot;href&quot;:&quot;http://docs.aws.amazon.com/appstream/latest/...</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;cognito-sync&#39;, path: &#39;/identitypools&#39;}))</div><div class="line">/*</div><div class="line">{&quot;Count&quot;:0,&quot;IdentityPoolUsages&quot;:[],&quot;MaxResults&quot;:16,&quot;NextToken&quot;:null}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;elastictranscoder&#39;, path: &#39;/2012-09-25/pipelines&#39;}))</div><div class="line">/*</div><div class="line">{&quot;NextPageToken&quot;:null,&quot;Pipelines&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;lambda&#39;, path: &#39;/2014-11-13/functions/&#39;}))</div><div class="line">/*</div><div class="line">{&quot;Functions&quot;:[],&quot;NextMarker&quot;:null}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;ecs&#39;, path: &#39;/?Action=ListClusters&amp;Version=2014-11-13&#39;}))</div><div class="line">/*</div><div class="line">&lt;ListClustersResponse xmlns=&quot;http://ecs.amazonaws.com/doc/2014-11-13/&quot;&gt;</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;glacier&#39;, path: &#39;/-/vaults&#39;, headers: {&#39;X-Amz-Glacier-Version&#39;: &#39;2012-06-01&#39;}}))</div><div class="line">/*</div><div class="line">{&quot;Marker&quot;:null,&quot;VaultList&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;storagegateway&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;StorageGateway_20120630.ListGateways&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;Gateways&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;datapipeline&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;DataPipeline.ListPipelines&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;hasMoreResults&quot;:false,&quot;pipelineIdList&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;opsworks&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;OpsWorks_20130218.DescribeStacks&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;Stacks&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;route53domains&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;Route53Domains_v20140515.ListDomains&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;Domains&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;kinesis&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;Kinesis_20131202.ListStreams&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;HasMoreStreams&quot;:false,&quot;StreamNames&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;cloudtrail&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;CloudTrail_20131101.DescribeTrails&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;trailList&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;logs&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;Logs_20140328.DescribeLogGroups&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;logGroups&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;codedeploy&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;CodeDeploy_20141006.ListApplications&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;applications&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;directconnect&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;OvertureService.DescribeConnections&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;connections&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;kms&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;TrentService.ListKeys&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;Keys&quot;:[],&quot;Truncated&quot;:false}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;config&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;StarlingDoveService.DescribeDeliveryChannels&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;DeliveryChannels&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({service: &#39;cloudhsm&#39;, body: &#39;{}&#39;, headers: {</div><div class="line">  &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">  &#39;X-Amz-Target&#39;: &#39;CloudHsmFrontendService.ListAvailableZones&#39;</div><div class="line">}}))</div><div class="line">/*</div><div class="line">{&quot;AZList&quot;:[&quot;us-east-1a&quot;,&quot;us-east-1b&quot;,&quot;us-east-1c&quot;]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({</div><div class="line">  service: &#39;swf&#39;,</div><div class="line">  body: &#39;{&quot;registrationStatus&quot;:&quot;REGISTERED&quot;}&#39;,</div><div class="line">  headers: {</div><div class="line">    &#39;Content-Type&#39;: &#39;application/x-amz-json-1.0&#39;,</div><div class="line">    &#39;X-Amz-Target&#39;: &#39;SimpleWorkflowService.ListDomains&#39;</div><div class="line">  }</div><div class="line">}))</div><div class="line">/*</div><div class="line">{&quot;domainInfos&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({</div><div class="line">  service: &#39;cognito-identity&#39;,</div><div class="line">  body: &#39;{&quot;MaxResults&quot;: 1}&#39;,</div><div class="line">  headers: {</div><div class="line">    &#39;Content-Type&#39;: &#39;application/x-amz-json-1.1&#39;,</div><div class="line">    &#39;X-Amz-Target&#39;: &#39;AWSCognitoIdentityService.ListIdentityPools&#39;</div><div class="line">  }</div><div class="line">}))</div><div class="line">/*</div><div class="line">{&quot;IdentityPools&quot;:[]}</div><div class="line">...</div><div class="line">*/</div><div class="line"></div><div class="line">request(aws4.sign({</div><div class="line">  service: &#39;mobileanalytics&#39;,</div><div class="line">  path: &#39;/2014-06-05/events&#39;,</div><div class="line">  body: JSON.stringify({events:[{</div><div class="line">    eventType: &#39;a&#39;,</div><div class="line">    timestamp: new Date().toISOString(),</div><div class="line">    session: {},</div><div class="line">  }]}),</div><div class="line">  headers: {</div><div class="line">    &#39;Content-Type&#39;: &#39;application/json&#39;,</div><div class="line">    &#39;X-Amz-Client-Context&#39;: JSON.stringify({</div><div class="line">      client: {client_id: &#39;a&#39;, app_title: &#39;a&#39;},</div><div class="line">      custom: {},</div><div class="line">      env: {platform: &#39;a&#39;},</div><div class="line">      services: {},</div><div class="line">    }),</div><div class="line">  }</div><div class="line">}))</div><div class="line">/*</div><div class="line">(HTTP 202, empty response)</div><div class="line">*/</div><div class="line"></div><div class="line">// Generate CodeCommit Git access password</div><div class="line">var signer = new aws4.RequestSigner({</div><div class="line">  service: &#39;codecommit&#39;,</div><div class="line">  host: &#39;git-codecommit.us-east-1.amazonaws.com&#39;,</div><div class="line">  method: &#39;GIT&#39;,</div><div class="line">  path: &#39;/v1/repos/MyAwesomeRepo&#39;,</div><div class="line">})</div><div class="line">var password = signer.getDateTime() + &#39;Z&#39; + signer.signature()</div></div><!-- fragment --><h2>API </h2>
<h3>aws4.sign(requestOptions, [credentials])</h3>
<p>This calculates and populates the <code>Authorization</code> header of <code>requestOptions</code>, and any other necessary AWS headers and/or request options. Returns <code>requestOptions</code> as a convenience for chaining.</p>
<p><code>requestOptions</code> is an object holding the same options that the node.js <a href="http://nodejs.org/docs/latest/api/http.html#http_http_request_options_callback">http.request</a> function takes.</p>
<p>The following properties of <code>requestOptions</code> are used in the signing or populated if they don't already exist:</p>
<ul>
<li><code>hostname</code> or <code>host</code> (will be determined from <code>service</code> and <code>region</code> if not given)</li>
<li><code>method</code> (will use &lsquo;'GET&rsquo;<code>if not given or</code>'POST'<code>if there is a</code>body<code>) -</code>path<code>(will use</code>'/'<code>if not given) -</code>body<code>(will use</code>''<code>if not given) -</code>service<code>(will be calculated from</code>hostname<code>or</code>host<code>if not given) -</code>region<code>(will be calculated from</code>hostname<code>or</code>host<code>or use</code>'us-east-1'<code>if not given) -</code>headers['Host']<code>(will use</code>hostname<code>or</code>host<code>or be calculated if not given) -</code>headers['Content-Type']<code>(will use</code>'application/x-www-form-urlencoded; charset=utf-8'<code> if not given and there is a</code>body<code>) -</code>headers['<a class="el" href="classDate.html">Date</a>']<code>(used to calculate the signature date if given, otherwise</code>new Date` is used)</li>
</ul>
<p>Your AWS credentials (which can be found in your <a href="https://portal.aws.amazon.com/gp/aws/securityCredentials">AWS console</a>) can be specified in one of two ways:</p>
<ul>
<li>As the second argument, like this:</li>
</ul>
<div class="fragment"><div class="line">aws4.sign(requestOptions, {</div><div class="line">  secretAccessKey: &quot;&lt;your-secret-access-key&gt;&quot;,</div><div class="line">  accessKeyId: &quot;&lt;your-access-key-id&gt;&quot;,</div><div class="line">  sessionToken: &quot;&lt;your-session-token&gt;&quot;</div><div class="line">})</div></div><!-- fragment --><ul>
<li>From <code>process.env</code>, such as this:</li>
</ul>
<div class="fragment"><div class="line">export AWS_SECRET_ACCESS_KEY=&quot;&lt;your-secret-access-key&gt;&quot;</div><div class="line">export AWS_ACCESS_KEY_ID=&quot;&lt;your-access-key-id&gt;&quot;</div><div class="line">export AWS_SESSION_TOKEN=&quot;&lt;your-session-token&gt;&quot;</div></div><!-- fragment --><p>(will also use <code>AWS_ACCESS_KEY</code> and <code>AWS_SECRET_KEY</code> if available)</p>
<p>The <code>sessionToken</code> property and <code>AWS_SESSION_TOKEN</code> environment variable are optional for signing with <a href="http://docs.aws.amazon.com/STS/latest/UsingSTS/using-temp-creds.html">IAM STS temporary credentials</a>.</p>
<h2>Installation </h2>
<p>With <a href="http://npmjs.org/">npm</a> do:</p>
<div class="fragment"><div class="line">npm install aws4</div></div><!-- fragment --><p>Can also be used <a href="./browser">in the browser</a>.</p>
<h2>Thanks </h2>
<p>Thanks to <a href="https://github.com/jed"></a> for his <a href="https://github.com/jed/dynamo-client">dynamo-client</a> lib where I first committed and subsequently extracted this code.</p>
<p>Also thanks to the <a href="https://github.com/aws/aws-sdk-js">official node.js AWS SDK</a> for giving me a start on implementing the v4 signature. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
